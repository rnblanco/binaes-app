"use strict";(self.webpackChunkpk_thunder_frontend=self.webpackChunkpk_thunder_frontend||[]).push([[173],{8173:(te,u,n)=>{n.r(u),n.d(u,{AreasModule:()=>ee});var l=n(6895),g=n(2248),y=n(2959),c=n(6894),p=n(8203),e=n(8274),d=n(433),m=n(1740),h=n(805),_=n(5593),f=n(1795),A=n(5722),S=n(7011),C=n(5047),T=n(3054),P=n(3026);const v=["userMultiSelect"],M=["areaTypeMultiSelect"],w=["floorAreaMultiSelect"];function N(a,s){1&a&&e._UZ(0,"app-loading",3)}function U(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.addAreaType())}),e.qZA()}if(2&a){const t=e.oxw(2);e.MGl("label","Agregar '",t.areaTypeText,"'")}}function F(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.addFloorArea())}),e.qZA()}if(2&a){const t=e.oxw(2);e.MGl("label","Agregar '",t.floorAreaText,"'")}}function E(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",26)(1,"button",27),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.delete())}),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("loading",t.deleteLoading)}}const R=function(a,s){return{"p-col-6 p-sm-9":a,"p-col-12":s}};function L(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"form",4,5)(2,"div",6)(3,"label"),e._uU(4,"Nombre (m\xe1ximo 30 caracteres):"),e.qZA(),e.TgZ(5,"div",7)(6,"input",8),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.name=o)}),e.qZA()()(),e.TgZ(7,"div",6)(8,"label"),e._uU(9,"Descripci\xf3n:"),e.qZA(),e.TgZ(10,"div",7)(11,"textarea",9),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.description=o)}),e.qZA()()(),e.TgZ(12,"div",10)(13,"label"),e._uU(14,"Encargado:"),e.qZA(),e.TgZ(15,"p-multiSelect",11,12),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedUser=o)})("onFilter",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.userFilter(o))})("onChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.userChange(o))}),e.qZA()(),e.TgZ(17,"div",13)(18,"label"),e._uU(19,"Capacidad del \xe1rea:"),e.qZA(),e.TgZ(20,"p-inputNumber",14),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.capacity=o)}),e.qZA()(),e.TgZ(21,"div",15)(22,"label"),e._uU(23,"Tipo de \xe1rea:"),e.qZA(),e.TgZ(24,"p-multiSelect",16,17),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedAreaType=o)})("onFilter",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.areaTypeFilter(o))})("onChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.areaTypeChange(o))}),e.YNc(26,U,1,1,"ng-template",18),e.qZA()(),e.TgZ(27,"div",15)(28,"label"),e._uU(29,"Piso:"),e.qZA(),e.TgZ(30,"p-multiSelect",19,20),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedFloorArea=o)})("onFilter",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.floorAreaFilter(o))})("onChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.floorAreaChange(o))}),e.YNc(32,F,1,1,"ng-template",18),e.qZA()(),e.TgZ(33,"div",21)(34,"div",22)(35,"button",23),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.add())}),e.ALo(36,"addOrEdit"),e.qZA()(),e.YNc(37,E,2,1,"div",24),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.name),e.xp6(5),e.Q6J("ngModel",t.description)("autoResize",!0),e.xp6(4),e.Q6J("options",t.users)("ngModel",t.selectedUser)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(5),e.Q6J("ngModel",t.capacity)("showButtons",!0)("min",0)("max",1e3),e.xp6(4),e.Q6J("options",t.areaTypes)("ngModel",t.selectedAreaType)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(6),e.Q6J("options",t.floorAreas)("ngModel",t.selectedFloorArea)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(4),e.Q6J("ngClass",e.WLB(29,R,t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew,t.isNew||t.user.id_rolUsuario!==t.SUPER_ADMIN)),e.xp6(1),e.Q6J("loading",t.addLoading)("label",e.lcZ(36,27,t.isNew))("disabled",!t.formIsValid),e.xp6(2),e.Q6J("ngIf",t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew)}}let x=(()=>{class a extends y.H{constructor(t){super(),this.route=t,this.SUPER_ADMIN=c.G.SUPER_ADMIN,this.isNew=!0,this.addLoading=!1,this.deleteLoading=!1,this.userText="",this.selectedUser=[],this.areaTypeText="",this.selectedAreaType=[],this.floorAreaText="",this.selectedFloorArea=[]}get formIsValid(){return""!==this.name&&""!==this.description&&this.capacity>0&&this.selectedUser?.length>0&&this.selectedAreaType?.length>0&&this.selectedFloorArea?.length>0}ngOnInit(){this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){this.subscription.add(this.route.params.subscribe(({id:t})=>{this.loading=!0,this.loadAreaTypes(),this.loadUsers(),this.loadFloorAreas(),t?(this.id=t,this.loadInfo()):this.loading=!1}))}delete(){this.deleteLoading=!0,this.subscription.add(this.catalogService.deleteOfURL(`AREA/${this.id}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El \xe1rea fue eliminada con \xe9xito"}),setTimeout(()=>{this.router.navigate([p.u.areasPage])},200),this.deleteLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar el \xe1rea"}),this.deleteLoading=!1}))}add(){this.isNew?(this.addLoading=!0,this.subscription.add(this.catalogService.addOfURL("AREA",{nombre:this.name,descripcion:this.description,capacidad:this.capacity,responsable:this.selectedUser[0],id_pisoArea:this.selectedFloorArea[0],id_tipoArea:this.selectedAreaType[0]}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El \xe1rea fue a\xf1adida satifactoriamente"}),setTimeout(()=>{this.router.navigate([p.u.areasPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el \xe1rea"}),this.addLoading=!1}))):this.update()}update(){this.addLoading=!0,this.subscription.add(this.catalogService.updateOfURL(`AREA/${this.id}`,{id_Area:this.id,nombre:this.name,descripcion:this.description,capacidad:this.capacity,responsable:this.selectedUser[0],id_pisoArea:this.selectedFloorArea[0],id_tipoArea:this.selectedAreaType[0]}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El \xe1rea fue editada satifactoriamente"}),setTimeout(()=>{this.router.navigate([p.u.areasPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo editar el \xe1rea"}),this.addLoading=!1}))}loadInfo(){this.subscription.add(this.catalogService.getByNameWithParams(`AREA/${this.id}`).subscribe(t=>{t.nombre&&(this.isNew=!1),this.id=t.id_Area,this.name=t.nombre,this.description=t.descripcion,this.capacity=t.capacidad,this.selectedUser=[t.USUARIO.id_Usuario],this.selectedAreaType=[t.TIPOAREA?.id_tipoArea],this.selectedFloorArea=[t.PISOAREA.id_pisoArea],setTimeout(()=>{this.loading=!1},200)},()=>{this.loading=!1,this.router.navigate([p.u.areasPage])}))}userFilter(t){this.userText=t.filter}userChange(t){this.selectedUser=[t.itemValue]}loadUsers(){this.subscription.add(this.catalogService.getByNameWithParams("ADMINISTRADORES").subscribe(t=>{this.users=t}))}areaTypeFilter(t){this.areaTypeText=t.filter}areaTypeChange(t){this.selectedAreaType=[t.itemValue]}addAreaType(){this.subscription.add(this.catalogService.addOfURL("TIPOAREA",{tipoArea1:this.areaTypeText}).subscribe(t=>{this.loadAreaTypes(),this.areaTypeMultiSelect.close(new Event("close")),this.selectedAreaType=[t.id_tipoArea]},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el tipo de \xe1rea"})}))}loadAreaTypes(){this.subscription.add(this.catalogService.getByNameWithParams("TIPOAREA").subscribe(t=>{this.areaTypes=t}))}floorAreaFilter(t){this.floorAreaText=t.filter}floorAreaChange(t){this.selectedFloorArea=[t.itemValue]}addFloorArea(){this.subscription.add(this.catalogService.addOfURL("PISOAREA",{pisoArea1:this.floorAreaText}).subscribe(t=>{this.loadFloorAreas(),this.floorAreaMultiSelect.close(new Event("close")),this.selectedFloorArea=[t.id_pisoArea]},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el tipo de \xe1rea"})}))}loadFloorAreas(){this.subscription.add(this.catalogService.getByNameWithParams("PISOAREA").subscribe(t=>{this.floorAreas=t}))}getBreadCrumbs(){return[{label:"\xc1reas",routerLink:[this.routeInformation.areasPage]},{label:"\xc1rea",routerLink:[this.routeInformation.areaPage]}]}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(g.gz))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-area-page"]],viewQuery:function(t,i){if(1&t&&(e.Gf(v,5),e.Gf(M,5),e.Gf(w,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.userMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.areaTypeMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.floorAreaMultiSelect=o.first)}},features:[e.qOj],decls:3,vars:2,consts:[[1,"card","p-mt-4"],["class","p-d-flex p-ai-center p-jc-center","style","height: 80%",4,"ngIf"],["autocomplete","off","class","p-fluid p-formgrid p-grid p-formgrid-sm p-ml-2 p-mr-2",4,"ngIf"],[1,"p-d-flex","p-ai-center","p-jc-center",2,"height","80%"],["autocomplete","off",1,"p-fluid","p-formgrid","p-grid","p-formgrid-sm","p-ml-2","p-mr-2"],["form","ngForm"],[1,"p-field","p-col-12"],[1,"p-input-icon-right"],["name","name","placeholder","Ej. \xc1rea de recreaci\xf3n","pInputText","","maxlength","30",3,"ngModel","ngModelChange"],["name","description","placeholder","Ej. Espacio para desarrollar las habilidades sociales","pInputTextarea","",3,"ngModel","autoResize","ngModelChange"],[1,"p-field","p-col-8","p-mt-2"],["name","selectedUser","defaultLabel","Elige un encargado","optionLabel","nombre","optionValue","id_Usuario","emptyFilterMessage","No se encontraron resultados",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["userMultiSelect",""],[1,"p-field","p-col-4","p-mt-2"],["name","capacity","inputId","minmax-buttons",3,"ngModel","showButtons","min","max","ngModelChange"],[1,"p-field","p-col-6","p-mt-2"],["name","selectedAreaType","defaultLabel","Elige un tipo","optionLabel","tipoArea1","optionValue","id_tipoArea",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["areaTypeMultiSelect",""],["pTemplate","emptyfilter"],["name","selectedFloorArea","defaultLabel","Elige un piso","optionLabel","pisoArea1","optionValue","id_pisoArea",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["floorAreaMultiSelect",""],[1,"p-col-12","p-grid","p-mt-4","p-ml-0","p-mr-0","p-pl-0","p-pr-0"],[1,"p-field",3,"ngClass"],["pButton","","pRipple","","type","button",1,"p-button-success",3,"loading","label","disabled","click"],["class","p-field p-col-6 p-sm-3",4,"ngIf"],["pButton","","pRipple","","type","button",1,"p-button-primary",3,"label","click"],[1,"p-field","p-col-6","p-sm-3"],["pButton","","pRipple","","type","button","label","Eliminar","icon","pi pi-trash",1,"p-button-danger",3,"loading","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,N,1,0,"app-loading",1),e.YNc(2,L,38,32,"form",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading))},dependencies:[l.mk,l.O5,d._Y,d.Fj,d.JJ,d.JL,d.nD,d.On,d.F,m.o,h.jx,_.Hq,f.H,A.NU,S.N,C.Rn,T.g,P.p],encapsulation:2}),a})();var Z=n(9908),I=n(414),b=n(7147);function J(a,s){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t?null:t.capacidad," ")}}function O(a,s){if(1&a&&(e.ynx(0),e._UZ(1,"p-chip",7),e.ALo(2,"titlecase"),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("image","assets/images/icons/user-circle.png")("label",e.lcZ(2,2,null==t||null==t.USUARIO?null:t.USUARIO.nombre))}}function G(a,s){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t?null:t.descripcion," ")}}function H(a,s){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t?null:t.nombre," ")}}function B(a,s){if(1&a&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&a){const t=e.oxw().$implicit,i=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,i[t.field])," ")}}function Q(a,s){if(1&a&&(e.TgZ(0,"td",4),e.YNc(1,J,2,1,"ng-container",5),e.YNc(2,O,3,4,"ng-container",5),e.YNc(3,G,2,1,"ng-container",5),e.YNc(4,H,2,1,"ng-container",5),e.YNc(5,B,3,3,"ng-container",6),e.qZA()),2&a){const t=s.$implicit;e.Udp("width",t.width,"px"),e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngSwitchCase","capacidad"),e.xp6(1),e.Q6J("ngSwitchCase","USUARIO.nombre"),e.xp6(1),e.Q6J("ngSwitchCase","descripcion"),e.xp6(1),e.Q6J("ngSwitchCase","nombre")}}function j(a,s){1&a&&e.YNc(0,Q,6,7,"td",3),2&a&&e.Q6J("ngForOf",s.columns)}const D=[{path:"",component:(()=>{class a extends Z.c{constructor(){super(),this.USER=c.G.USER,this.cols=[{field:"nombre",header:"Nombre",width:150},{field:"descripcion",header:"Descripci\xf3n",width:200},{field:"USUARIO.nombre",header:"Responsable",width:100},{field:"capacidad",header:"Capacidad",width:100}]}ngOnInit(){this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){this.list=[],this.loading=!0,this.getPaginationParams(),this.subscription.add(this.catalogService.getByNameWithParams("AREA",this.httpParams).subscribe(t=>{this.pagination=t.meta,this.currentPage=this.pagination.currentPage,this.list=t.data,this.loading=!1},()=>this.loading=!1))}onLazyLoad(t){this.paginate(t),this.loadAll()}onNew(){this.user.id_rolUsuario!==c.G.USER&&this.router.navigate([`${this.routeInformation.areaPage}/`])}onRowSelect({data:t}){this.user.id_rolUsuario!==c.G.USER&&this.router.navigate([`${this.routeInformation.areaPage}/${t.id_Area}/`])}getBreadCrumbs(){return[{label:"\xc1reas",routerLink:[this.routeInformation.areasPage]}]}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-areas-page"]],features:[e.qOj],decls:3,vars:8,consts:[[1,"p-mt-4"],["newButtonLabel","Nueva \xe1rea","type","\xe1reas",3,"reloading","globalFilter","rows","pagination","loading","cols","list","showNewButton","onLazyLoad","onRowSelect","onNewClick"],["pTemplate","body"],["class","text-center",3,"ngSwitch","width",4,"ngFor","ngForOf"],[1,"text-center",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["styleClass","p-col-12",3,"image","label"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"table-card",1),e.NdJ("onLazyLoad",function(r){return i.onLazyLoad(r)})("onRowSelect",function(r){return i.onRowSelect(r)})("onNewClick",function(){return i.onNew()}),e.YNc(2,j,1,1,"ng-template",2),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("reloading",i.loading)("globalFilter",i.globalFilter)("rows",i.rows)("pagination",i.pagination)("loading",i.loading)("cols",i.cols)("list",i.list)("showNewButton",i.user.id_rolUsuario!==i.USER))},dependencies:[l.sg,l.RF,l.n9,l.ED,I.r,h.jx,b.A,l.rS],encapsulation:2}),a})()},{path:"area",component:x},{path:"area/:id",component:x}];let K=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.Bz.forChild(D),g.Bz]}),a})();var Y=n(6311),z=n(8433),$=n(4466),V=n(9423),W=n(585),X=n(3388),k=n(529),q=n(8783);let ee=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[l.ez,K,Y.j,d.u5,m.j,z.ON,_.hJ,f.T,A.q4,$.m,V.I,W._8,X.O,k.JF,C.L$,T.A,q.LU,b.o]}),a})()}}]);