"use strict";(self.webpackChunkpk_thunder_frontend=self.webpackChunkpk_thunder_frontend||[]).push([[909],{1909:(pe,C,l)=>{l.r(C),l.d(C,{UsersModule:()=>ce});var d=l(9808),g=l(6507),I=l(9908),u=l(6894),e=l(7587),S=l(414),v=l(9783),U=l(4178);function k(s,a){if(1&s&&(e.ynx(0),e._UZ(1,"img",7),e.ALo(2,"photo"),e.BQk()),2&s){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("src",e.lcZ(2,1,null==t?null:t.fotografia),e.LSH)}}function A(s,a){if(1&s&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&s){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.nombre)," ")}}function N(s,a){if(1&s&&(e.ynx(0),e._uU(1),e.BQk()),2&s){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t?null:t.email," ")}}function E(s,a){if(1&s&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&s){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.telefono)," ")}}function R(s,a){if(1&s&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&s){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.ocupacion)," ")}}function F(s,a){if(1&s&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&s){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.direccion)," ")}}function L(s,a){if(1&s&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&s){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.institucion)," ")}}function Z(s,a){if(1&s&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&s){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.ROLUSUARIO.rol)," ")}}function B(s,a){if(1&s&&(e.ynx(0),e._uU(1),e.BQk()),2&s){const t=e.oxw().$implicit,i=e.oxw().rowData;e.xp6(1),e.hij(" ",i[t.field]," ")}}function V(s,a){if(1&s&&(e.TgZ(0,"td",4),e.YNc(1,k,3,3,"ng-container",5),e.YNc(2,A,3,3,"ng-container",5),e.YNc(3,N,2,1,"ng-container",5),e.YNc(4,E,3,3,"ng-container",5),e.YNc(5,R,3,3,"ng-container",5),e.YNc(6,F,3,3,"ng-container",5),e.YNc(7,L,3,3,"ng-container",5),e.YNc(8,Z,3,3,"ng-container",5),e.YNc(9,B,2,1,"ng-container",6),e.qZA()),2&s){const t=a.$implicit;e.Udp("width",t.width,"px"),e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngSwitchCase","fotografia"),e.xp6(1),e.Q6J("ngSwitchCase","nombre"),e.xp6(1),e.Q6J("ngSwitchCase","email"),e.xp6(1),e.Q6J("ngSwitchCase","telefono"),e.xp6(1),e.Q6J("ngSwitchCase","ocupacion"),e.xp6(1),e.Q6J("ngSwitchCase","direccion"),e.xp6(1),e.Q6J("ngSwitchCase","institucion"),e.xp6(1),e.Q6J("ngSwitchCase","ROLUSUARIO.rol")}}function J(s,a){1&s&&e.YNc(0,V,10,11,"td",3),2&s&&e.Q6J("ngForOf",a.columns)}let O=(()=>{class s extends I.c{constructor(){super(),this.USER=u.G.USER,this.cols=[{field:"nombre",header:"Nombre",width:100},{field:"email",header:"Email",width:100},{field:"telefono",header:"Tel\xe9fono",width:100},{field:"ocupacion",header:"Ocupaci\xf3n",width:10},{field:"direccion",header:"direcci\xf3n",width:10},{field:"fotografia",header:"Fotograf\xeda",width:100},{field:"institucion",header:"Instituci\xf3n",width:100},{field:"ROLUSUARIO.rol",header:"Rol",width:100}]}ngOnInit(){this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){var t,i;this.list=[],this.loading=!0,this.getPaginationParams(),this.subscription.add(this.catalogService.getByNameWithParams("USUARIO",this.httpParams.set("id_rolUsuario",null!==(t=this.user.id_rolUsuario)&&void 0!==t?t:0).set("id_Usuario",null!==(i=this.user.id_Usuario)&&void 0!==i?i:0)).subscribe(n=>{this.pagination=n.meta,this.currentPage=this.pagination.currentPage,this.list=n.data,this.loading=!1},()=>this.loading=!1))}onLazyLoad(t){this.paginate(t),this.loadAll()}onNew(){this.user.id_rolUsuario!==u.G.USER&&this.router.navigate([`${this.routeInformation.userPage}/`])}onRowSelect({data:t}){this.user.id_rolUsuario!==u.G.USER&&this.router.navigate([`${this.routeInformation.userPage}/${t.id_Usuario}/`])}getBreadCrumbs(){var t;return[{label:"Usuarios "+((null===(t=this.user)||void 0===t?void 0:t.ROLUSUARIO.id_rolUsuario)===u.G.SUPER_ADMIN?"y Administradores":""),routerLink:[this.routeInformation.usersPage]}]}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users-page"]],features:[e.qOj],decls:3,vars:8,consts:[[1,"p-mt-4"],["newButtonLabel","Nuevo usuario","type","usuarios",3,"reloading","globalFilter","rows","pagination","loading","cols","list","showNewButton","onLazyLoad","onRowSelect","onNewClick"],["pTemplate","body"],["class","text-center",3,"ngSwitch","width",4,"ngFor","ngForOf"],[1,"text-center",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[2,"height","8rem",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"table-card",1),e.NdJ("onLazyLoad",function(o){return i.onLazyLoad(o)})("onRowSelect",function(o){return i.onRowSelect(o)})("onNewClick",function(){return i.onNew()}),e.YNc(2,J,1,1,"ng-template",2),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("reloading",i.loading)("globalFilter",i.globalFilter)("rows",i.rows)("pagination",i.pagination)("loading",i.loading)("cols",i.cols)("list",i.list)("showNewButton",i.user.id_rolUsuario!==i.USER))},directives:[S.r,v.jx,d.sg,d.RF,d.n9,d.ED],pipes:[U.A,d.rS],encapsulation:2}),s})();var Q=l(2959),p=l(8203),m=l(8205),w=l(520),D=l(7011),c=l(2382),f=l(1424),M=l(6526),_=l(5730);const j=["input"];function H(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"i",3),e.NdJ("click",function(){return e.CHM(t),e.oxw().clear()}),e.qZA()}}const Y={provide:c.JU,useExisting:(0,e.Gpc)(()=>b),multi:!0};let b=(()=>{class s{constructor(t,i){this.el=t,this.cd=i,this.type="text",this.slotChar="_",this.autoClear=!0,this.showClear=!1,this.characterPattern="[A-Za-z]",this.onComplete=new e.vpe,this.onFocus=new e.vpe,this.onBlur=new e.vpe,this.onInput=new e.vpe,this.onKeydown=new e.vpe,this.onClear=new e.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{}}ngOnInit(){let t=_.p.getUserAgent();this.androidChrome=/chrome/i.test(t)&&/android/i.test(t),this.initMask()}get mask(){return this._mask}set mask(t){this._mask=t,this.initMask(),this.writeValue(""),this.onModelChange(this.value)}initMask(){this.tests=[],this.partialPosition=this.mask.length,this.len=this.mask.length,this.firstNonMaskPos=null,this.defs={9:"[0-9]",a:this.characterPattern,"*":`${this.characterPattern}|[0-9]`};let t=this.mask.split("");for(let i=0;i<t.length;i++){let n=t[i];"?"==n?(this.len--,this.partialPosition=i):this.defs[n]?(this.tests.push(new RegExp(this.defs[n])),null===this.firstNonMaskPos&&(this.firstNonMaskPos=this.tests.length-1),i<this.partialPosition&&(this.lastRequiredNonMaskPos=this.tests.length-1)):this.tests.push(null)}this.buffer=[];for(let i=0;i<t.length;i++){let n=t[i];"?"!=n&&this.buffer.push(this.defs[n]?this.getPlaceholder(i):n)}this.defaultBuffer=this.buffer.join("")}writeValue(t){this.value=t,this.inputViewChild&&this.inputViewChild.nativeElement&&(this.inputViewChild.nativeElement.value=null==this.value||null==this.value?"":this.value,this.checkVal(),this.focusText=this.inputViewChild.nativeElement.value,this.updateFilledState())}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}caret(t,i){let n,o,r;if(this.inputViewChild.nativeElement.offsetParent&&this.inputViewChild.nativeElement===this.inputViewChild.nativeElement.ownerDocument.activeElement){if("number"!=typeof t)return this.inputViewChild.nativeElement.setSelectionRange?(o=this.inputViewChild.nativeElement.selectionStart,r=this.inputViewChild.nativeElement.selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),o=0-n.duplicate().moveStart("character",-1e5),r=o+n.text.length),{begin:o,end:r};o=t,r="number"==typeof i?i:o,this.inputViewChild.nativeElement.setSelectionRange?this.inputViewChild.nativeElement.setSelectionRange(o,r):this.inputViewChild.nativeElement.createTextRange&&(n=this.inputViewChild.nativeElement.createTextRange(),n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",o),n.select())}}isCompleted(){for(let i=this.firstNonMaskPos;i<=this.lastRequiredNonMaskPos;i++)if(this.tests[i]&&this.buffer[i]===this.getPlaceholder(i))return!1;return!0}getPlaceholder(t){return this.slotChar.charAt(t<this.slotChar.length?t:0)}seekNext(t){for(;++t<this.len&&!this.tests[t];);return t}seekPrev(t){for(;--t>=0&&!this.tests[t];);return t}shiftL(t,i){let n,o;if(!(t<0)){for(n=t,o=this.seekNext(i);n<this.len;n++)if(this.tests[n]){if(!(o<this.len&&this.tests[n].test(this.buffer[o])))break;this.buffer[n]=this.buffer[o],this.buffer[o]=this.getPlaceholder(o),o=this.seekNext(o)}this.writeBuffer(),this.caret(Math.max(this.firstNonMaskPos,t))}}shiftR(t){let i,n,o,r;for(i=t,n=this.getPlaceholder(t);i<this.len;i++)if(this.tests[i]){if(o=this.seekNext(i),r=this.buffer[i],this.buffer[i]=n,!(o<this.len&&this.tests[o].test(r)))break;n=r}}handleAndroidInput(t){var i=this.inputViewChild.nativeElement.value,n=this.caret();if(this.oldVal&&this.oldVal.length&&this.oldVal.length>i.length){for(this.checkVal(!0);n.begin>0&&!this.tests[n.begin-1];)n.begin--;if(0===n.begin)for(;n.begin<this.firstNonMaskPos&&!this.tests[n.begin];)n.begin++;setTimeout(()=>{this.caret(n.begin,n.begin),this.updateModel(t),this.isCompleted()&&this.onComplete.emit()},0)}else{for(this.checkVal(!0);n.begin<this.len&&!this.tests[n.begin];)n.begin++;setTimeout(()=>{this.caret(n.begin,n.begin),this.updateModel(t),this.isCompleted()&&this.onComplete.emit()},0)}}onInputBlur(t){if(this.focused=!1,this.onModelTouched(),this.checkVal(),this.updateFilledState(),this.onBlur.emit(t),this.inputViewChild.nativeElement.value!=this.focusText||this.inputViewChild.nativeElement.value!=this.value){this.updateModel(t);let i=document.createEvent("HTMLEvents");i.initEvent("change",!0,!1),this.inputViewChild.nativeElement.dispatchEvent(i)}}onInputKeydown(t){if(this.readonly)return;let n,o,r,i=t.which||t.keyCode,h=/iphone/i.test(_.p.getUserAgent());this.oldVal=this.inputViewChild.nativeElement.value,this.onKeydown.emit(t),8===i||46===i||h&&127===i?(n=this.caret(),o=n.begin,r=n.end,r-o==0&&(o=46!==i?this.seekPrev(o):r=this.seekNext(o-1),r=46===i?this.seekNext(r):r),this.clearBuffer(o,r),this.shiftL(o,r-1),this.updateModel(t),this.onInput.emit(t),t.preventDefault()):13===i?(this.onInputBlur(t),this.updateModel(t)):27===i&&(this.inputViewChild.nativeElement.value=this.focusText,this.caret(0,this.checkVal()),this.updateModel(t),t.preventDefault())}onKeyPress(t){if(!this.readonly){var o,r,h,T,i=t.which||t.keyCode,n=this.caret();t.ctrlKey||t.altKey||t.metaKey||i<32||i>34&&i<41||(i&&13!==i&&(n.end-n.begin!=0&&(this.clearBuffer(n.begin,n.end),this.shiftL(n.begin,n.end-1)),(o=this.seekNext(n.begin-1))<this.len&&(r=String.fromCharCode(i),this.tests[o].test(r)&&(this.shiftR(o),this.buffer[o]=r,this.writeBuffer(),h=this.seekNext(o),/android/i.test(_.p.getUserAgent())?setTimeout(()=>{this.caret(h)},0):this.caret(h),n.begin<=this.lastRequiredNonMaskPos&&(T=this.isCompleted()),this.onInput.emit(t))),t.preventDefault()),this.updateModel(t),this.updateFilledState(),T&&this.onComplete.emit())}}clearBuffer(t,i){let n;for(n=t;n<i&&n<this.len;n++)this.tests[n]&&(this.buffer[n]=this.getPlaceholder(n))}writeBuffer(){this.inputViewChild.nativeElement.value=this.buffer.join("")}checkVal(t){let o,r,h,i=this.inputViewChild.nativeElement.value,n=-1;for(o=0,h=0;o<this.len;o++)if(this.tests[o]){for(this.buffer[o]=this.getPlaceholder(o);h++<i.length;)if(r=i.charAt(h-1),this.tests[o].test(r)){this.buffer[o]=r,n=o;break}if(h>i.length){this.clearBuffer(o+1,this.len);break}}else this.buffer[o]===i.charAt(h)&&h++,o<this.partialPosition&&(n=o);return t?this.writeBuffer():n+1<this.partialPosition?this.autoClear||this.buffer.join("")===this.defaultBuffer?(this.inputViewChild.nativeElement.value&&(this.inputViewChild.nativeElement.value=""),this.clearBuffer(0,this.len)):this.writeBuffer():(this.writeBuffer(),this.inputViewChild.nativeElement.value=this.inputViewChild.nativeElement.value.substring(0,n+1)),this.partialPosition?o:this.firstNonMaskPos}onInputFocus(t){if(this.readonly)return;let i;this.focused=!0,clearTimeout(this.caretTimeoutId),this.focusText=this.inputViewChild.nativeElement.value,i=this.checkVal(),this.caretTimeoutId=setTimeout(()=>{this.inputViewChild.nativeElement===this.inputViewChild.nativeElement.ownerDocument.activeElement&&(this.writeBuffer(),i==this.mask.replace("?","").length?this.caret(0,i):this.caret(i))},10),this.onFocus.emit(t)}onInputChange(t){this.androidChrome?this.handleAndroidInput(t):this.handleInputChange(t),this.onInput.emit(t)}handleInputChange(t){this.readonly||setTimeout(()=>{var i=this.checkVal(!0);this.caret(i),this.updateModel(t),this.isCompleted()&&this.onComplete.emit()},0)}getUnmaskedValue(){let t=[];for(let i=0;i<this.buffer.length;i++){let n=this.buffer[i];this.tests[i]&&n!=this.getPlaceholder(i)&&t.push(n)}return t.join("")}updateModel(t){const i=this.unmask?this.getUnmaskedValue():t.target.value;(null!==i||void 0!==i)&&(this.value=i,this.onModelChange(this.value))}updateFilledState(){this.filled=this.inputViewChild.nativeElement&&""!=this.inputViewChild.nativeElement.value}focus(){this.inputViewChild.nativeElement.focus()}clear(){this.inputViewChild.nativeElement.value="",this.value=null,this.onModelChange(this.value),this.onClear.emit()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(e.SBq),e.Y36(e.sBO))},s.\u0275cmp=e.Xpm({type:s,selectors:[["p-inputMask"]],viewQuery:function(t,i){if(1&t&&e.Gf(j,7),2&t){let n;e.iGM(n=e.CRH())&&(i.inputViewChild=n.first)}},hostAttrs:[1,"p-element"],hostVars:6,hostBindings:function(t,i){2&t&&e.ekj("p-inputwrapper-filled",i.filled)("p-inputwrapper-focus",i.focused)("p-inputmask-clearable",i.showClear&&!i.disabled)},inputs:{type:"type",slotChar:"slotChar",autoClear:"autoClear",showClear:"showClear",style:"style",inputId:"inputId",styleClass:"styleClass",placeholder:"placeholder",size:"size",maxlength:"maxlength",tabindex:"tabindex",title:"title",ariaLabel:"ariaLabel",ariaRequired:"ariaRequired",disabled:"disabled",readonly:"readonly",unmask:"unmask",name:"name",required:"required",characterPattern:"characterPattern",autoFocus:"autoFocus",autocomplete:"autocomplete",mask:"mask"},outputs:{onComplete:"onComplete",onFocus:"onFocus",onBlur:"onBlur",onInput:"onInput",onKeydown:"onKeydown",onClear:"onClear"},features:[e._Bn([Y])],decls:3,vars:18,consts:[["pInputText","",1,"p-inputmask",3,"ngStyle","ngClass","disabled","readonly","focus","blur","keydown","keypress","input","paste"],["input",""],["class","p-inputmask-clear-icon pi pi-times",3,"click",4,"ngIf"],[1,"p-inputmask-clear-icon","pi","pi-times",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"input",0,1),e.NdJ("focus",function(o){return i.onInputFocus(o)})("blur",function(o){return i.onInputBlur(o)})("keydown",function(o){return i.onInputKeydown(o)})("keypress",function(o){return i.onKeyPress(o)})("input",function(o){return i.onInputChange(o)})("paste",function(o){return i.handleInputChange(o)}),e.qZA(),e.YNc(2,H,1,0,"i",2)),2&t&&(e.Q6J("ngStyle",i.style)("ngClass",i.styleClass)("disabled",i.disabled)("readonly",i.readonly),e.uIk("id",i.inputId)("type",i.type)("name",i.name)("placeholder",i.placeholder)("title",i.title)("size",i.size)("autocomplete",i.autocomplete)("maxlength",i.maxlength)("tabindex",i.tabindex)("aria-label",i.ariaLabel)("aria-required",i.ariaRequired)("required",i.required)("autofocus",i.autoFocus),e.xp6(2),e.Q6J("ngIf",null!=i.value&&i.filled&&i.showClear&&!i.disabled))},directives:[f.o,d.PC,d.mk,d.O5],styles:[".p-inputmask-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-inputmask-clearable{position:relative}\n"],encapsulation:2,changeDetection:0}),s})(),G=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[d.ez,f.j]]}),s})();var x=l(845),y=l(5787),z=l(3026);const q=["rolMultiSelect"];function $(s,a){1&s&&e._UZ(0,"app-loading",3)}function K(s,a){if(1&s&&(e._UZ(0,"img",27),e.ALo(1,"photo")),2&s){const t=e.oxw(3);let i;e.s9C("src",e.lcZ(1,2,t.uploadedFile[0]),e.LSH),e.s9C("alt",null!==(i=t.uploadedFile[0])&&void 0!==i?i:"No disponible")}}function W(s,a){if(1&s&&e.YNc(0,K,2,4,"img",26),2&s){const t=e.oxw(2);e.Q6J("ngIf",t.uploadedFile[0]&&!t.selectedfiles[0])}}function X(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"div",28)(1,"button",29),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).delete()}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("loading",t.deleteLoading)}}const ee=function(s,a){return{"p-col-6 p-sm-9":s,"p-col-12":a}};function te(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"form",4,5)(2,"div",6)(3,"label"),e._uU(4,"Nombre:"),e.qZA(),e.TgZ(5,"div",7)(6,"input",8),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().name=n}),e.qZA()()(),e.TgZ(7,"div",9)(8,"label"),e._uU(9,"Instituci\xf3n:"),e.qZA(),e.TgZ(10,"div",7)(11,"input",10),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().institucion=n}),e.qZA()()(),e.TgZ(12,"div",9)(13,"label"),e._uU(14,"Ocupaci\xf3n:"),e.qZA(),e.TgZ(15,"div",7)(16,"input",11),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().ocupacion=n}),e.qZA()()(),e.TgZ(17,"div",6)(18,"label"),e._uU(19,"Email:"),e.qZA(),e.TgZ(20,"div",7)(21,"input",12),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().email=n}),e.qZA()()(),e.TgZ(22,"div",9)(23,"label"),e._uU(24,"Contrase\xf1a:"),e.qZA(),e.TgZ(25,"div",7)(26,"input",13),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().contrasena=n}),e.qZA()()(),e.TgZ(27,"div",9)(28,"label"),e._uU(29,"Rol:"),e.qZA(),e.TgZ(30,"p-multiSelect",14,15),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().selectedRol=n})("onFilter",function(n){return e.CHM(t),e.oxw().rolFilter(n)})("onChange",function(n){return e.CHM(t),e.oxw().rolChange(n)}),e.qZA()(),e.TgZ(32,"div",16)(33,"label"),e._uU(34,"Direcci\xf3n:"),e.qZA(),e.TgZ(35,"div",7)(36,"input",17),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().direccion=n}),e.qZA()()(),e.TgZ(37,"div",9)(38,"label"),e._uU(39,"Tel\xe9fono:"),e.qZA(),e.TgZ(40,"div",7)(41,"p-inputMask",18),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().telefono=n}),e.qZA()()(),e.TgZ(42,"div",19)(43,"label"),e._uU(44,"Portada:"),e.qZA(),e.TgZ(45,"p-fileUpload",20),e.NdJ("onSelect",function(n){return e.CHM(t),e.oxw().onSelectFile(n)})("onUpload",function(n){return e.CHM(t),e.oxw().onUpload(n)}),e.YNc(46,W,1,1,"ng-template",21),e.qZA()(),e.TgZ(47,"div",22)(48,"div",23)(49,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw().add()}),e.ALo(50,"addOrEdit"),e.qZA()(),e.YNc(51,X,2,1,"div",25),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.name),e.xp6(5),e.Q6J("ngModel",t.institucion),e.xp6(5),e.Q6J("ngModel",t.ocupacion),e.xp6(5),e.Q6J("ngModel",t.email),e.xp6(5),e.Q6J("ngModel",t.contrasena),e.xp6(4),e.Q6J("options",t.roles)("ngModel",t.selectedRol)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(6),e.Q6J("ngModel",t.direccion),e.xp6(5),e.Q6J("ngModel",t.telefono),e.xp6(4),e.Q6J("showUploadButton",!1)("showCancelButton",!1),e.xp6(3),e.Q6J("ngClass",e.WLB(21,ee,t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew,t.isNew||t.user.id_rolUsuario!==t.SUPER_ADMIN)),e.xp6(1),e.Q6J("loading",t.addLoading)("label",e.lcZ(50,19,t.isNew))("disabled",!t.formIsValid),e.xp6(2),e.Q6J("ngIf",t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew)}}let P=(()=>{class s extends Q.H{constructor(t,i){super(),this.route=t,this.http=i,this.isNew=!0,this.uploadedFile=[],this.selectedfiles=[],this.SUPER_ADMIN=u.G.SUPER_ADMIN,this.addLoading=!1,this.deleteLoading=!1,this.rolText="",this.selectedRol=[],this.onUploadFinished=new e.vpe}get formIsValid(){var t;return""!==this.name&&""!==this.email&&""!==this.telefono&&""!==this.ocupacion&&""!==this.institucion&&""!==this.direccion&&(null===(t=this.selectedRol)||void 0===t?void 0:t.length)>0&&(null!=this.uploadedFiles||this.uploadedFile.length>0)}ngOnInit(){this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){this.subscription.add(this.route.params.subscribe(({id:t})=>{this.loading=!0,this.loadRoles(),t?(this.id=t,this.loadInfo()):this.loading=!1}))}delete(){this.deleteLoading=!0,this.subscription.add(this.catalogService.deleteOfURL(`USUARIO/${this.id}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El usuario fue eliminado con \xe9xito"}),setTimeout(()=>{this.router.navigate([p.u.exemplarsPage])},200),this.deleteLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar el usuario"}),this.deleteLoading=!1}))}add(){this.isNew?(void 0!==this.uploadedFiles&&this.uploadFile(),this.addLoading=!0,this.subscription.add(this.catalogService.addOfURL("USUARIO",{id_Usuario:this.makeid(),nombre:this.name,email:this.email,telefono:this.telefono,ocupacion:this.ocupacion,direccion:this.direccion,fotografia:this.varbinaryImage,institucion:this.institucion,id_rolUsuario:this.selectedRol[0],contrasena:""!==this.contrasena?this.encrypt(this.contrasena):""}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El usuario fue a\xf1adido satifactoriamente"}),setTimeout(()=>{this.router.navigate([p.u.usersPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir al usuario"}),this.addLoading=!1}))):this.update()}update(){void 0!==this.uploadedFiles&&this.uploadFile(),this.addLoading=!0,this.subscription.add(this.catalogService.updateOfURL(`USUARIO/${this.id}`,{id_Usuario:this.id,nombre:this.name,email:this.email,telefono:this.telefono,ocupacion:this.ocupacion,direccion:this.direccion,fotografia:void 0===this.varbinaryImage?btoa(this.uploadedFile[0]):this.varbinaryImage,institucion:this.institucion,id_rolUsuario:this.selectedRol[0],contrasena:void 0===this.contrasena?"":this.encrypt(this.contrasena)}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El usuario fue editado satifactoriamente"}),setTimeout(()=>{this.router.navigate([p.u.usersPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo editar el usuario"}),this.addLoading=!1}))}onUpload(t){for(let i of t.files)this.uploadedFile.push(i)}onSelectFile(t){this.uploadedFiles=[...t.files],this.varbinaryImage=btoa(this.uploadedFiles[0].name),this.selectedfiles=this.uploadedFiles}uploadFile(){const t=new FormData;let i;i=new File([this.uploadedFiles[0]],this.uploadedFiles[0].name,{type:"application/png"}),t.append("file",i,i.name),this.subscription.add(this.catalogService.addOfURL("UploadImage",t).subscribe(()=>{}))}loadInfo(){this.subscription.add(this.catalogService.getByNameWithParams(`USUARIO/${this.id}`).subscribe(t=>{t.id_Usuario&&(this.isNew=!1),(t.id_Usuario==this.user.id_Usuario||t.id_rolUsuario==this.user.id_rolUsuario||t.ROLUSUARIO.id_rolUsuario==u.G.SUPER_ADMIN)&&(this.messageService.setPayload({type:"warn",title:"Error",body:"No puede editar a ese usuario"}),this.router.navigate([p.u.usersPage])),this.name=t.nombre,this.email=t.email,this.telefono=t.telefono,this.ocupacion=t.ocupacion,this.direccion=t.direccion,this.uploadedFile.push(t.fotografia),this.institucion=t.institucion,this.selectedRol.push(t.ROLUSUARIO.id_rolUsuario),setTimeout(()=>{this.loading=!1},200)},()=>{this.loading=!1,this.router.navigate([p.u.userPage])}))}rolFilter(t){this.rolText=t.filter}rolChange(t){this.selectedRol=[t.itemValue]}loadRoles(){this.subscription.add(this.catalogService.getByNameWithParams("ROLUSUARIO").subscribe(t=>{this.roles=t,this.user.id_rolUsuario==u.G.ADMIN?this.roles=this.roles.filter(i=>i.id_rolUsuario!=u.G.SUPER_ADMIN&&i.id_rolUsuario!=u.G.ADMIN):this.user.id_rolUsuario==u.G.SUPER_ADMIN&&(this.roles=this.roles.filter(i=>i.id_rolUsuario!=u.G.SUPER_ADMIN))}))}makeid(){let t="",i="0123456789";for(var n=0;n<8;n++)t+=i.charAt(Math.floor(Math.random()*i.length));return t}getBreadCrumbs(){var t,i;return[{label:"Usuarios "+((null===(t=this.user)||void 0===t?void 0:t.ROLUSUARIO.id_rolUsuario)===u.G.SUPER_ADMIN?"y Administradores":""),routerLink:[this.routeInformation.usersPage]},{label:"Usuario "+((null===(i=this.user)||void 0===i?void 0:i.ROLUSUARIO.id_rolUsuario)===u.G.SUPER_ADMIN?"y Administrador":""),routerLink:[this.routeInformation.userPage]}]}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(g.gz),e.Y36(w.eN))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-user-page"]],viewQuery:function(t,i){if(1&t&&(e.Gf(m.p,5),e.Gf(q,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.fileUpload=n.first),e.iGM(n=e.CRH())&&(i.rolMultiSelect=n.first)}},outputs:{onUploadFinished:"onUploadFinished"},features:[e.qOj],decls:3,vars:2,consts:[[1,"card","p-mt-4"],["class","p-d-flex p-ai-center p-jc-center","style","height: 80%",4,"ngIf"],["autocomplete","off","class","p-fluid p-formgrid p-grid p-formgrid-sm p-ml-2 p-mr-2",4,"ngIf"],[1,"p-d-flex","p-ai-center","p-jc-center",2,"height","80%"],["autocomplete","off",1,"p-fluid","p-formgrid","p-grid","p-formgrid-sm","p-ml-2","p-mr-2"],["form","ngForm"],[1,"p-field","p-col-6"],[1,"p-input-icon-right"],["name","name","placeholder","Ej. Juan Perez","pInputText","",3,"ngModel","ngModelChange"],[1,"p-field","p-col-3"],["name","institucion","placeholder","Ej. Binaes","pInputText","",3,"ngModel","ngModelChange"],["name","ocupacion","placeholder","Ej. estudiante","pInputText","",3,"ngModel","ngModelChange"],["name","email","placeholder","Ej. correo@gmail.com","pInputText","",3,"ngModel","ngModelChange"],["name","contrasena","type","password","placeholder","\u2022\u2022\u2022\u2022\u2022","pInputText","",3,"ngModel","ngModelChange"],["name","selectedRol","defaultLabel","Elige un tipo","optionLabel","rol","optionValue","id_rolUsuario",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["editorialMultiSelect",""],[1,"p-field","p-col-9"],["name","direccion","placeholder","Ej. Carretera Francisco Javier, 697, Hab. 76","pInputText","",3,"ngModel","ngModelChange"],["name","telefono","mask","+50399999999","placeholder","Ej. +50377777777",3,"ngModel","ngModelChange"],[1,"p-field","p-col-12","p-mt-2"],["name","demo[]","chooseLabel","Agregar","invalidFileTypeMessageSummary","{0}: Este formato de archivo no es v\xe1lido.","invalidFileTypeMessageDetail","tipos v\xe1lidos: {0}","accept","image/png",3,"showUploadButton","showCancelButton","onSelect","onUpload"],["pTemplate","content"],[1,"p-col-12","p-grid","p-mt-2"],[3,"ngClass"],["pButton","","pRipple","","type","button",1,"p-button-success",3,"loading","label","disabled","click"],["class","p-field p-col-6 p-sm-3",4,"ngIf"],["style","height:10em","class","p-ml-2",3,"src","alt",4,"ngIf"],[1,"p-ml-2",2,"height","10em",3,"src","alt"],[1,"p-field","p-col-6","p-sm-3"],["pButton","","pRipple","","type","button","label","Eliminar","icon","pi pi-trash",1,"p-button-danger",3,"loading","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,$,1,0,"app-loading",1),e.YNc(2,te,52,24,"form",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading))},directives:[d.O5,D.N,c._Y,c.JL,c.F,c.Fj,f.o,c.JJ,c.On,M.NU,b,m.p,v.jx,d.mk,x.Hq,y.H],pipes:[U.A,z.p],encapsulation:2}),s})();const ie=[{path:"",component:O,pathMatch:"full"},{path:"user",component:P},{path:"user/:id",component:P}];let ne=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[g.Bz.forChild(ie)],g.Bz]}),s})();var se=l(8007),oe=l(5055),ae=l(4466),le=l(9423),re=l(5652),ue=l(7010),de=l(3407),he=l(3725);let ce=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[d.ez,ne,se.j,c.u5,f.j,oe.ON,x.hJ,y.T,M.q4,ae.m,le.I,re._8,m.O,w.JF,ue.L$,de.A,he.LU,G]]}),s})()}}]);