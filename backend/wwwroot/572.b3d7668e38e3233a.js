"use strict";(self.webpackChunkpk_thunder_frontend=self.webpackChunkpk_thunder_frontend||[]).push([[572],{572:(gt,y,s)=>{s.r(y),s.d(y,{ExemplarsModule:()=>ht});var p=s(6895),E=s(2248),R=s(9908),m=s(6894),T=s(4331),e=s(8274),Z=s(414),u=s(805),w=s(4178);function J(a,n){if(1&a&&(e.ynx(0),e._UZ(1,"img",7),e.ALo(2,"photo"),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("src",e.lcZ(2,1,null==t?null:t.imagen),e.LSH)}}function U(a,n){if(1&a&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,null==t?null:t.f_publicacion,"dd-MM-yyyy")," ")}}function K(a,n){if(1&a&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t||null==t.EDITORIAL?null:t.EDITORIAL.editorial1)," ")}}function D(a,n){if(1&a&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t||null==t.FORMATOEJEMPLAR?null:t.FORMATOEJEMPLAR.formato)," ")}}function B(a,n){if(1&a&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t||null==t.IDIOMAEJEMPLAR?null:t.IDIOMAEJEMPLAR.idioma)," ")}}function V(a,n){if(1&a&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t||null==t.COLECCION?null:t.COLECCION.nombre)," ")}}const j=function(){return{background:"#FFDEE9",color:"#704050"}};function H(a,n){if(1&a&&(e.TgZ(0,"div",9)(1,"span",10),e._uU(2),e.qZA()()),2&a){const t=n.$implicit;e.Akn(e.DdM(3,j)),e.xp6(2),e.hij(" ",null==t||null==t.AUTOR?null:t.AUTOR.nombre," ")}}function Q(a,n){if(1&a&&(e.ynx(0),e.YNc(1,H,3,4,"div",8),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("ngForOf",t.AUTORxEJEMPLAR)}}function G(a,n){if(1&a&&(e.TgZ(0,"div",9)(1,"span",10),e._uU(2),e.qZA()()),2&a){const t=n.$implicit;e.xp6(2),e.Oqu(null==t?null:t.p_clave)}}function q(a,n){if(1&a&&(e.ynx(0),e.YNc(1,G,3,1,"div",11),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("ngForOf",t.P_CLAVE)}}const Y=function(){return{background:"#EAE0FF",color:"#694382"}};function $(a,n){if(1&a&&(e.TgZ(0,"div",9)(1,"span",10),e._uU(2),e.qZA()()),2&a){const t=n.$implicit;e.Akn(e.DdM(3,Y)),e.xp6(2),e.hij(" ",null==t?null:t.etiqueta,"")}}function z(a,n){if(1&a&&(e.ynx(0),e.YNc(1,$,3,4,"div",8),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("ngForOf",t.ETIQUETASxEJEMPLAR)}}function X(a,n){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw().$implicit,i=e.oxw().rowData;e.xp6(1),e.hij(" ",i[t.field]," ")}}function W(a,n){if(1&a&&(e.TgZ(0,"td",4),e.YNc(1,J,3,3,"ng-container",5),e.YNc(2,U,3,4,"ng-container",5),e.YNc(3,K,3,3,"ng-container",5),e.YNc(4,D,3,3,"ng-container",5),e.YNc(5,B,3,3,"ng-container",5),e.YNc(6,V,3,3,"ng-container",5),e.YNc(7,Q,2,1,"ng-container",5),e.YNc(8,q,2,1,"ng-container",5),e.YNc(9,z,2,1,"ng-container",5),e.YNc(10,X,2,1,"ng-container",6),e.qZA()),2&a){const t=n.$implicit;e.Udp("width",t.width,"px"),e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngSwitchCase","imagen"),e.xp6(1),e.Q6J("ngSwitchCase","f_publicacion"),e.xp6(1),e.Q6J("ngSwitchCase","EDITORIAL.editorial1"),e.xp6(1),e.Q6J("ngSwitchCase","FORMATOEJEMPLAR.formato"),e.xp6(1),e.Q6J("ngSwitchCase","IDIOMAEJEMPLAR.idioma"),e.xp6(1),e.Q6J("ngSwitchCase","COLECCION.nombre"),e.xp6(1),e.Q6J("ngSwitchCase","autorE"),e.xp6(1),e.Q6J("ngSwitchCase","p_clave"),e.xp6(1),e.Q6J("ngSwitchCase","etiqueta_E")}}function ee(a,n){1&a&&e.YNc(0,W,11,12,"td",3),2&a&&e.Q6J("ngForOf",n.columns)}let te=(()=>{class a extends R.c{constructor(){super(),this.tagType=T.Q,this.USER=m.G.USER,this.cols=[{field:"nombre",header:"Nombre",width:120},{field:"imagen",header:"Imagen",width:80},{field:"EDITORIAL.editorial1",header:"Editorial",width:100},{field:"FORMATOEJEMPLAR.formato",header:"Formato",width:90},{field:"IDIOMAEJEMPLAR.idioma",header:"Idioma",width:90},{field:"COLECCION.nombre",header:"Colecci\xf3n",width:120},{field:"p_clave",header:"Palabra(s)",width:120},{field:"autorE",header:"Autor(es)",width:120},{field:"etiqueta_E",header:"Etiqueta(s)",width:120},{field:"f_publicacion",header:"Publicaci\xf3n",width:120}]}ngOnInit(){this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){this.list=[],this.loading=!0,this.getPaginationParams(),this.subscription.add(this.catalogService.getByNameWithParams("EJEMPLAR",this.httpParams).subscribe(t=>{this.pagination=t.meta,this.currentPage=this.pagination.currentPage,this.list=t.data,this.loading=!1},()=>this.loading=!1))}onLazyLoad(t){this.paginate(t),this.loadAll()}onNew(){this.user.id_rolUsuario!==m.G.USER&&this.router.navigate([`${this.routeInformation.exemplarPage}/`])}onRowSelect({data:t}){this.user.id_rolUsuario!==m.G.USER&&this.router.navigate([`${this.routeInformation.exemplarPage}/${t.id_Ejemplar}/`])}getBreadCrumbs(){return[{label:"Ejemplares",routerLink:[this.routeInformation.exemplarsPage]}]}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-exemplars-page"]],features:[e.qOj],decls:3,vars:8,consts:[[1,"p-mt-4"],["newButtonLabel","Nuevo Ejemplar","type","ejemplares",3,"reloading","globalFilter","rows","pagination","loading","cols","list","showNewButton","onLazyLoad","onRowSelect","onNewClick"],["pTemplate","body"],["class","text-center",3,"ngSwitch","width",4,"ngFor","ngForOf"],[1,"text-center",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[2,"height","8rem",3,"src"],["class","custom-chip p-mr-0 p-mb-2",3,"style",4,"ngFor","ngForOf"],[1,"custom-chip","p-mr-0","p-mb-2"],[1,"custom-chip-label"],["class","custom-chip p-mr-0 p-mb-2",4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"table-card",1),e.NdJ("onLazyLoad",function(l){return i.onLazyLoad(l)})("onRowSelect",function(l){return i.onRowSelect(l)})("onNewClick",function(){return i.onNew()}),e.YNc(2,ee,1,1,"ng-template",2),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("reloading",i.loading)("globalFilter",i.globalFilter)("rows",i.rows)("pagination",i.pagination)("loading",i.loading)("cols",i.cols)("list",i.list)("showNewButton",i.user.id_rolUsuario!==i.USER))},dependencies:[p.sg,p.RF,p.n9,p.ED,Z.r,u.jx,p.rS,p.uU,w.A],encapsulation:2}),a})();var ie=s(9322),_=s(8203),g=s(529),c=s(433),C=s(3564);c.F.prototype.resetValidation=function(){Object.keys(this.controls).forEach(a=>{const n=this.controls[a];n.markAsPristine(),n.markAsUntouched()})};var f=s(1740),M=s(5593),A=s(1795),P=s(5722),ae=s(7011),S=s(585),F=s(3388),N=s(3608),b=s(8783),oe=s(7579),le=s(4986),ne=s(5963),re=s(4482),pe=s(5032),I=s(5403),de=s(8421),me=s(9722);let ue=(()=>{class a{constructor(t,i,o,l){this.model=t,this.el=i,this.renderer=o,this.tagPipe=l,this.onMask=new e.vpe,this.NewEventSubject=new oe.x,this.NewEvent=this.NewEventSubject.pipe(function ce(a){return(0,re.e)((n,t)=>{let i=!1,o=null,l=null;const r=()=>{if(l?.unsubscribe(),l=null,i){i=!1;const d=o;o=null,t.next(d)}};n.subscribe((0,I.x)(t,d=>{l?.unsubscribe(),i=!0,o=d,l=(0,I.x)(t,r,pe.Z),(0,de.Xf)(a(d)).subscribe(l)},()=>{r(),t.complete()},void 0,()=>{o=l=null}))})}(()=>function se(a=0,n=le.z){return a<0&&(a=0),(0,ne.H)(a,a,n)}(100))),this.NewEvent.subscribe(()=>{this.onMask.emit(this.tagPipe.transform(this.model.model,this.tagType))})}ngOnInit(){this.onMask.emit(this.tagPipe.transform(this.model.model,this.tagType))}onKeyUp(t){t.preventDefault(),this.NewEventSubject.next(t)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(c.On),e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(me.d))},a.\u0275dir=e.lG2({type:a,selectors:[["input","tagMask",""]],hostBindings:function(t,i){1&t&&e.NdJ("keyup",function(l){return i.onKeyUp(l)})},inputs:{tagType:"tagType"},outputs:{onMask:"onMask"}}),a})();const _e=["inputtext"];function he(a,n){1&a&&e.GkF(0)}function ge(a,n){if(1&a&&(e.TgZ(0,"span",12),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit,i=e.oxw();e.xp6(1),e.Oqu(i.field?i.resolveFieldData(t,i.field):t)}}function fe(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"span",13),e.NdJ("click",function(o){e.CHM(t);const l=e.oxw().index,r=e.oxw();return e.KtG(r.removeItem(o,l))}),e.qZA()}}const xe=function(a){return{$implicit:a}};function Ee(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li",7,8),e.NdJ("click",function(o){const r=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.onItemClick(o,r))}),e.YNc(2,he,1,0,"ng-container",9),e.YNc(3,ge,2,1,"span",10),e.YNc(4,fe,1,0,"span",11),e.qZA()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",i.itemTemplate)("ngTemplateOutletContext",e.VKq(4,xe,t)),e.xp6(1),e.Q6J("ngIf",!i.itemTemplate),e.xp6(1),e.Q6J("ngIf",!i.disabled)}}function Ce(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"i",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.clear())}),e.qZA()}}const be=function(a,n){return{"p-inputtext p-chips-multiple-container":!0,"p-focus":a,"p-disabled":n}},ve=function(a){return{"p-chips-clearable":a}},ye={provide:c.JU,useExisting:(0,e.Gpc)(()=>O),multi:!0};let O=(()=>{class a{constructor(t,i){this.el=t,this.cd=i,this.allowDuplicate=!0,this.showClear=!1,this.onAdd=new e.vpe,this.onRemove=new e.vpe,this.onFocus=new e.vpe,this.onBlur=new e.vpe,this.onChipClick=new e.vpe,this.onClear=new e.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{}}ngAfterContentInit(){this.templates.forEach(t=>{t.getType(),this.itemTemplate=t.template}),this.updateFilledState()}onClick(){this.inputViewChild.nativeElement.focus()}onInput(){this.updateFilledState()}onPaste(t){this.disabled||(this.separator&&((t.clipboardData||window.clipboardData).getData("Text").split(this.separator).forEach(o=>{this.addItem(t,o,!0)}),this.inputViewChild.nativeElement.value=""),this.updateFilledState())}updateFilledState(){this.filled=!(!this.value||0===this.value.length)||this.inputViewChild&&this.inputViewChild.nativeElement&&""!=this.inputViewChild.nativeElement.value}onItemClick(t,i){this.onChipClick.emit({originalEvent:t,value:i})}writeValue(t){this.value=t,this.updateMaxedOut(),this.updateFilledState(),this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}resolveFieldData(t,i){if(t&&i){if(-1==i.indexOf("."))return t[i];{let r=i.split("."),d=t;for(var o=0,l=r.length;o<l;++o)d=d[r[o]];return d}}return null}onInputFocus(t){this.focus=!0,this.onFocus.emit(t)}onInputBlur(t){this.focus=!1,this.addOnBlur&&this.inputViewChild.nativeElement.value&&this.addItem(t,this.inputViewChild.nativeElement.value,!1),this.onModelTouched(),this.onBlur.emit(t)}removeItem(t,i){if(this.disabled)return;let o=this.value[i];this.value=this.value.filter((l,r)=>r!=i),this.onModelChange(this.value),this.onRemove.emit({originalEvent:t,value:o}),this.updateFilledState(),this.updateMaxedOut()}addItem(t,i,o){this.value=this.value||[],i&&i.trim().length&&(this.allowDuplicate||-1===this.value.indexOf(i))&&(this.value=[...this.value,i],this.onModelChange(this.value),this.onAdd.emit({originalEvent:t,value:i})),this.updateFilledState(),this.updateMaxedOut(),this.inputViewChild.nativeElement.value="",o&&t.preventDefault()}clear(){this.value=null,this.updateFilledState(),this.onModelChange(this.value),this.onClear.emit()}onKeydown(t){switch(t.which){case 8:if(0===this.inputViewChild.nativeElement.value.length&&this.value&&this.value.length>0){this.value=[...this.value];let i=this.value.pop();this.onModelChange(this.value),this.onRemove.emit({originalEvent:t,value:i}),this.updateFilledState()}break;case 13:this.addItem(t,this.inputViewChild.nativeElement.value,!0);break;case 9:this.addOnTab&&""!==this.inputViewChild.nativeElement.value&&this.addItem(t,this.inputViewChild.nativeElement.value,!0);break;default:this.max&&this.value&&this.max===this.value.length?t.preventDefault():this.separator&&","===this.separator&&188===t.which&&this.addItem(t,this.inputViewChild.nativeElement.value,!0)}}updateMaxedOut(){this.inputViewChild&&this.inputViewChild.nativeElement&&(this.inputViewChild.nativeElement.disabled=!(!this.max||!this.value||this.max!==this.value.length)||this.disabled||!1)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(e.sBO))},a.\u0275cmp=e.Xpm({type:a,selectors:[["p-chips"]],contentQueries:function(t,i,o){if(1&t&&e.Suo(o,u.jx,4),2&t){let l;e.iGM(l=e.CRH())&&(i.templates=l)}},viewQuery:function(t,i){if(1&t&&e.Gf(_e,5),2&t){let o;e.iGM(o=e.CRH())&&(i.inputViewChild=o.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(t,i){2&t&&e.ekj("p-inputwrapper-filled",i.filled)("p-inputwrapper-focus",i.focus)("p-chips-clearable",i.showClear)},inputs:{style:"style",styleClass:"styleClass",disabled:"disabled",field:"field",placeholder:"placeholder",max:"max",ariaLabelledBy:"ariaLabelledBy",tabindex:"tabindex",inputId:"inputId",allowDuplicate:"allowDuplicate",inputStyle:"inputStyle",inputStyleClass:"inputStyleClass",addOnTab:"addOnTab",addOnBlur:"addOnBlur",separator:"separator",showClear:"showClear"},outputs:{onAdd:"onAdd",onRemove:"onRemove",onFocus:"onFocus",onBlur:"onBlur",onChipClick:"onChipClick",onClear:"onClear"},features:[e._Bn([ye])],decls:8,vars:21,consts:[[3,"ngClass","ngStyle","click"],[3,"ngClass"],["class","p-chips-token",3,"click",4,"ngFor","ngForOf"],[1,"p-chips-input-token",3,"ngClass"],["type","text",3,"disabled","ngStyle","keydown","input","paste","focus","blur"],["inputtext",""],["class","p-chips-clear-icon pi pi-times",3,"click",4,"ngIf"],[1,"p-chips-token",3,"click"],["token",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","p-chips-token-label",4,"ngIf"],["class","p-chips-token-icon pi pi-times-circle",3,"click",4,"ngIf"],[1,"p-chips-token-label"],[1,"p-chips-token-icon","pi","pi-times-circle",3,"click"],[1,"p-chips-clear-icon","pi","pi-times",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return i.onClick()}),e.TgZ(1,"ul",1),e.YNc(2,Ee,5,6,"li",2),e.TgZ(3,"li",3)(4,"input",4,5),e.NdJ("keydown",function(l){return i.onKeydown(l)})("input",function(){return i.onInput()})("paste",function(l){return i.onPaste(l)})("focus",function(l){return i.onInputFocus(l)})("blur",function(l){return i.onInputBlur(l)}),e.qZA()(),e.TgZ(6,"li"),e.YNc(7,Ce,1,0,"i",6),e.qZA()()()),2&t&&(e.Tol(i.styleClass),e.Q6J("ngClass","p-chips p-component")("ngStyle",i.style),e.xp6(1),e.Q6J("ngClass",e.WLB(16,be,i.focus,i.disabled)),e.xp6(1),e.Q6J("ngForOf",i.value),e.xp6(1),e.Q6J("ngClass",e.VKq(19,ve,i.showClear&&!i.disabled)),e.xp6(1),e.Tol(i.inputStyleClass),e.Q6J("disabled",i.disabled)("ngStyle",i.inputStyle),e.uIk("id",i.inputId)("placeholder",i.value&&i.value.length?null:i.placeholder)("tabindex",i.tabindex)("aria-labelledby",i.ariaLabelledBy),e.xp6(3),e.Q6J("ngIf",null!=i.value&&i.filled&&!i.disabled&&i.showClear))},dependencies:[p.mk,p.PC,p.sg,p.tP,p.O5],styles:[".p-chips{display:inline-flex}.p-chips-multiple-container{margin:0;padding:0;list-style-type:none;cursor:text;overflow:hidden;display:flex;align-items:center;flex-wrap:wrap}.p-chips-token{cursor:default;display:inline-flex;align-items:center;flex:0 0 auto}.p-chips-input-token{flex:1 1 auto;display:inline-flex}.p-chips-token-icon{cursor:pointer}.p-chips-input-token input{border:0 none;outline:0 none;background-color:transparent;margin:0;padding:0;box-shadow:none;border-radius:0;width:100%}.p-fluid .p-chips{display:flex}.p-chips-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-chips-clearable .p-inputtext{position:relative}\n"],encapsulation:2,changeDetection:0}),a})(),Te=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[p.ez,f.j,u.m8],f.j,u.m8]}),a})();var we=s(3026);const Me=["editorialMultiSelect"],Ae=["collectionMultiSelect"],Pe=["formatoMultiSelect"],Se=["idiomaMultiSelect"],Fe=["keywordMultiSelect"],Ne=["authorMultiSelect"],Ie=["tagMultiSelect"],Oe=["tagForm"];function Le(a,n){1&a&&e._UZ(0,"app-loading",3)}function ke(a,n){1&a&&e._uU(0),2&a&&e.hij(" ",n.$implicit.etiqueta," ")}function Re(a,n){1&a&&(e.TgZ(0,"span",26),e._uU(1," Por favor ingresa una etiqueta v\xe1lida"),e.qZA())}function Ze(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"form",21)(1,"div",22),e._UZ(2,"input",23),e.ALo(3,"uppercase"),e.TgZ(4,"button",24),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.addTag(o.id_tipoEtiqueta))}),e._uU(5," Agregar "),e.qZA()(),e.YNc(6,Re,2,0,"span",25),e.qZA()}if(2&a){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("formGroup",i.form),e.xp6(2),e.s9C("pTooltip",i.isNew?"Se debe registrar el ejemplar primero":""),e.Q6J("placeholder",e.lcZ(3,5,t.tipoEtiqueta1)),e.xp6(2),e.Q6J("disabled",!i.form.valid),e.xp6(2),e.Q6J("ngIf",i.validatorService.validField(i.form,"DOI"))}}function Je(a,n){1&a&&(e.TgZ(0,"span",26),e._uU(1," Por favor ingresa una etiqueta v\xe1lida"),e.qZA())}function Ue(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"form",27,28)(2,"div",22)(3,"input",29),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw(4);return e.KtG(l.tagName=o)})("onMask",function(o){e.CHM(t);const l=e.oxw(4);return e.KtG(l.onMask(o))}),e.ALo(4,"uppercase"),e.qZA(),e.TgZ(5,"button",30),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.addTag(o.id_tipoEtiqueta))}),e._uU(6," Agregar "),e.qZA()(),e.YNc(7,Je,2,0,"span",25),e.qZA()}if(2&a){const t=e.MAs(1),i=e.oxw().$implicit,o=e.oxw(3);e.xp6(3),e.s9C("pTooltip",o.isNew?"Se debe registrar el ejemplar primero":""),e.Q6J("disabled",o.isNew)("ngModel",o.tagName)("tagType",i.id_tipoEtiqueta)("placeholder",e.lcZ(4,7,i.tipoEtiqueta1)),e.xp6(2),e.Q6J("disabled",0===(null==o.tagName?null:o.tagName.length)),e.xp6(2),e.Q6J("ngIf",(null==t||null==t.controls||null==t.controls.tagName?null:t.controls.tagName.errors)&&((null==t||null==t.controls||null==t.controls.tagName?null:t.controls.tagName.touched)||(null==t||null==t.controls||null==t.controls.tagName?null:t.controls.tagName.dirty)))}}const Ke=function(){return{standalone:!0}};function De(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"p-tabPanel",17),e.ALo(1,"uppercase"),e.TgZ(2,"p-chips",18),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw(3);return e.KtG(l.tagsxExemplar=o)})("onRemove",function(o){e.CHM(t);const l=e.oxw(3);return e.KtG(l.deleteTagToExemplar(o))}),e.YNc(3,ke,1,1,"ng-template",11),e.qZA(),e.YNc(4,Ze,7,7,"form",19),e.YNc(5,Ue,8,9,"ng-template",null,20,e.W1O),e.qZA()}if(2&a){const t=n.$implicit,i=n.index,o=e.MAs(6),l=e.oxw(3);e.s9C("pTooltip",l.isNew?"Se debe registrar el ejemplar primero":""),e.Q6J("header",e.lcZ(1,11,t.tipoEtiqueta1))("selected",0===i)("disabled",l.isNew),e.xp6(2),e.s9C("pTooltip",l.isNew?"Se debe registrar el ejemplar primero":""),e.Q6J("ngModel",l.tagsxExemplar)("max",(null==l.tagsxExemplar?null:l.tagsxExemplar.length)||0)("ngModelOptions",e.DdM(13,Ke))("disabled",l.isNew),e.xp6(2),e.Q6J("ngIf",t.id_tipoEtiqueta===l.DOI)("ngIfElse",o)}}function Be(a,n){if(1&a&&(e.TgZ(0,"p-tabView"),e.YNc(1,De,7,14,"p-tabPanel",16),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.tagTypes)}}const x=function(){return{width:"100%"}};function Ve(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div",31)(1,"div",32),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"button",33),e.NdJ("click",function(o){const r=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.deleteKeyword(o,r.id_p_clave))}),e.qZA()()()}if(2&a){const t=n.$implicit;e.Akn(e.DdM(3,x)),e.xp6(2),e.hij(" ",t.p_clave," ")}}function je(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(17),l=e.oxw();return e.KtG(l.addKeyword(o))}),e.qZA()}if(2&a){const t=e.oxw(2);e.MGl("label","Agregar '",t.keywordText,"'")}}function He(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div",31)(1,"div",32),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"button",33),e.NdJ("click",function(o){const r=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.deleteAuthor(o,r.id_Autor))}),e.qZA()()()}if(2&a){const t=n.$implicit;e.Akn(e.DdM(3,x)),e.xp6(2),e.hij(" ",t.nombre," ")}}function Qe(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(17),l=e.oxw();return e.KtG(l.addAuthor(o))}),e.qZA()}if(2&a){const t=e.oxw(2);e.MGl("label","Agregar '",t.authorText,"'")}}function Ge(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"form",4,5)(2,"div",6)(3,"label"),e._uU(4,"Etiquetas:"),e.qZA(),e.YNc(5,Be,2,1,"p-tabView",7),e.qZA(),e.TgZ(6,"div",8)(7,"label"),e._uU(8,"Palabras clave:"),e.qZA(),e.TgZ(9,"p-multiSelect",9,10),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedKeywords=o)})("onFilter",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.keywordsFilter(o))})("onChange",function(o){e.CHM(t);const l=e.MAs(17),r=e.oxw();return e.KtG(r.keywordsChange(o,l))}),e.YNc(11,Ve,5,4,"ng-template",11),e.YNc(12,je,1,1,"ng-template",12),e.qZA()(),e.TgZ(13,"div",13)(14,"label"),e._uU(15,"Autores:"),e.qZA(),e.TgZ(16,"p-multiSelect",14,15),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedAuthors=o)})("onFilter",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.authorFilter(o))})("onChange",function(o){e.CHM(t);const l=e.MAs(17),r=e.oxw();return e.KtG(r.authorChange(o,l))}),e.YNc(18,He,5,4,"ng-template",11),e.YNc(19,Qe,1,1,"ng-template",12),e.qZA()()()}if(2&a){const t=e.oxw();let i;e.xp6(5),e.Q6J("ngIf",null!==(i=null==t.tagTypes?null:t.tagTypes.length)&&void 0!==i&&i),e.xp6(4),e.s9C("pTooltip",t.isNew?"Se debe registrar el ejemplar primero":""),e.Q6J("options",t.keywords)("ngModel",t.selectedKeywords)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0)("disabled",t.isNew),e.xp6(7),e.s9C("pTooltip",t.isNew?"Se debe registrar el ejemplar primero":""),e.Q6J("options",t.authors)("ngModel",t.selectedAuthors)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0)("disabled",t.isNew)}}function qe(a,n){1&a&&e._UZ(0,"app-loading",3)}function Ye(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div",31)(1,"div",32),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"button",33),e.NdJ("click",function(){const l=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.deleteEditorial(l.id_Editorial))}),e.qZA()()()}if(2&a){const t=n.$implicit;e.Akn(e.DdM(3,x)),e.xp6(2),e.hij(" ",t.editorial1," ")}}function $e(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.addEditorial())}),e.qZA()}if(2&a){const t=e.oxw(2);e.MGl("label","Agregar '",t.editorialText,"'")}}function ze(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div",31)(1,"div",32),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"button",33),e.NdJ("click",function(){const l=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.deleteIdioma(l.id_idiomaEjemplar))}),e.qZA()()()}if(2&a){const t=n.$implicit;e.Akn(e.DdM(3,x)),e.xp6(2),e.hij(" ",t.idioma," ")}}function Xe(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.addIdioma())}),e.qZA()}if(2&a){const t=e.oxw(2);e.MGl("label","Agregar '",t.idiomaText,"'")}}function We(a,n){if(1&a&&(e._UZ(0,"img",60),e.ALo(1,"photo")),2&a){const t=e.oxw(3);let i;e.s9C("src",e.lcZ(1,2,t.uploadFile.uploadedFile[0]),e.LSH),e.s9C("alt",null!==(i=t.uploadFile.uploadedFile[0])&&void 0!==i?i:"No disponible")}}function et(a,n){if(1&a&&e.YNc(0,We,2,4,"img",59),2&a){const t=e.oxw(2);e.Q6J("ngIf",t.uploadFile.uploadedFile[0]&&!t.uploadFile.selectedfiles[0])}}function tt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div",61)(1,"button",62),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.delete())}),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("loading",t.deleteLoading)}}const it=function(a,n){return{"p-col-6 p-sm-9":a,"p-col-12":n}};function at(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"form",4,35)(2,"div",36)(3,"label"),e._uU(4,"Nombre:"),e.qZA(),e.TgZ(5,"div",37)(6,"input",38),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.name=o)}),e.qZA()()(),e.TgZ(7,"div",39)(8,"label"),e._uU(9,"Editorial:"),e.qZA(),e.TgZ(10,"p-multiSelect",40,41),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedEditorial=o)})("onFilter",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.editorialFilter(o))})("onChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.editorialChange(o))}),e.YNc(12,Ye,5,4,"ng-template",11),e.YNc(13,$e,1,1,"ng-template",12),e.qZA()(),e.TgZ(14,"div",42)(15,"label"),e._uU(16,"Idioma:"),e.qZA(),e.TgZ(17,"p-multiSelect",43,44),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedIdioma=o)})("onFilter",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.idiomaFilter(o))})("onChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.idiomaChange(o))}),e.YNc(19,ze,5,4,"ng-template",11),e.YNc(20,Xe,1,1,"ng-template",12),e.qZA()(),e.TgZ(21,"div",42)(22,"label"),e._uU(23,"Formato:"),e.qZA(),e.TgZ(24,"p-multiSelect",45,46),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedFormato=o)})("onFilter",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.formatoFilter(o))})("onChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.formatoChange(o))}),e.qZA()(),e.TgZ(26,"div",47)(27,"label"),e._uU(28,"Colecci\xf3n:"),e.qZA(),e.TgZ(29,"p-multiSelect",48,49),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedCollection=o)})("onFilter",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.collectionFilter(o))})("onChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.collectionChange(o))}),e.qZA()(),e.TgZ(31,"div",50)(32,"label"),e._uU(33,"Fecha de publicaci\xf3n:"),e.qZA(),e.TgZ(34,"div",51)(35,"p-calendar",52),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.date=o)}),e.qZA()()(),e.TgZ(36,"div",8)(37,"label"),e._uU(38,"Portada:"),e.qZA(),e.TgZ(39,"p-fileUpload",53),e.NdJ("onSelect",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.uploadFile.onSelectFile(o))})("onUpload",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.uploadFile.onUpload(o))}),e.YNc(40,et,1,1,"ng-template",54),e.qZA()(),e.TgZ(41,"div",55)(42,"div",56)(43,"button",57),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.add())}),e.ALo(44,"addOrEdit"),e.qZA()(),e.YNc(45,tt,2,1,"div",58),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.name),e.xp6(4),e.Q6J("options",t.editoriales)("ngModel",t.selectedEditorial)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(7),e.Q6J("options",t.idiomas)("ngModel",t.selectedIdioma)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(7),e.Q6J("options",t.formatos)("ngModel",t.selectedFormato)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(5),e.Q6J("options",t.collections)("ngModel",t.selectedCollection)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(6),e.Q6J("ngModel",t.date)("maxDate",t.maxDate)("selectOtherMonths",!0),e.xp6(4),e.Q6J("showUploadButton",!1)("showCancelButton",!1),e.xp6(3),e.Q6J("ngClass",e.WLB(33,it,t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew,t.isNew||t.user.id_rolUsuario!==t.SUPER_ADMIN)),e.xp6(1),e.Q6J("loading",t.addLoading)("label",e.lcZ(44,31,t.isNew))("disabled",!t.formIsValid),e.xp6(2),e.Q6J("ngIf",t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew)}}let L=(()=>{class a extends ie.H{constructor(t,i){super(),this.route=t,this.uploadFile=i,this.DOI=T.Q.DOI,this.SUPER_ADMIN=m.G.SUPER_ADMIN,this.isNew=!0,this.addLoading=!1,this.deleteLoading=!1,this.editorialText="",this.selectedEditorial=[],this.collectionText="",this.selectedCollection=[],this.formatoText="",this.selectedFormato=[],this.idiomaText="",this.selectedIdioma=[],this.keywordText="",this.selectedKeywords=[],this.selectedKeywordsxExemplar=[],this.keywordsxExemplar=[],this.authorText="",this.selectedAuthors=[],this.selectedAuthorsxExemplar=[],this.selectedTags=[]}get formIsValid(){return""!==this.name&&this.selectedEditorial?.length>0&&this.selectedIdioma?.length>0&&this.selectedFormato?.length>0&&this.selectedCollection?.length>0&&void 0!==this.date&&(void 0!==this.uploadFile.uploadedFiles||this.uploadFile.uploadedFile?.length>0)}ngOnInit(){this.uploadFile=new C.R,this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs()),this.maxDate=new Date,this.form=this.formBuilder.group({DOI:[void 0,[c.kI.required,c.kI.pattern(this.validatorService.DOIPattern)]]})}loadAll(){this.user.ROLUSUARIO.id_rolUsuario===m.G.USER&&(this.messageService.setPayload({type:"warn",title:"Error",body:"No tienes autorizaci\xf3n para ver esta informaci\xf3n"}),setTimeout(()=>{this.router.navigate([_.u.exemplarsPage])},50)),this.subscription.add(this.route.params.subscribe(({id:t})=>{this.loading=!0,this.loadEditoriales(),this.loadIdioma(),this.loadFormatos(),this.loadCollections(),this.loadTagTypes(),t?(this.id=t,this.loadInfo(),this.loadKeywords(),this.loadAuthors(),this.loadTags()):this.loading=!1}))}delete(){this.deleteLoading=!0,this.subscription.add(this.catalogService.deleteOfURL(`EJEMPLAR/${this.id}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El ejemplar fue eliminado con \xe9xito"}),setTimeout(()=>{this.router.navigate([_.u.exemplarsPage])},200),this.deleteLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"No se pudo eliminar",body:"El ejemplar tiene elementos relacionados"}),this.deleteLoading=!1}))}add(){this.isNew?(void 0!==this.uploadFile.uploadedFiles&&this.uploadFile.uploadFile(),this.addLoading=!0,this.subscription.add(this.catalogService.addOfURL("EJEMPLAR",{nombre:this.name,imagen:this.uploadFile.varbinaryImage,f_publicacion:this.date,id_Idioma:this.selectedIdioma[0],id_Formato:this.selectedFormato[0],id_Editorial:this.selectedEditorial[0],id_coleccionPertenece:this.selectedCollection[0]}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El ejemplar fue a\xf1adido satifactoriamente"}),setTimeout(()=>{this.router.navigate([_.u.exemplarsPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el ejemplar"}),this.addLoading=!1}))):this.update()}update(){void 0!==this.uploadFile.uploadedFiles&&this.uploadFile.uploadFile(),this.addLoading=!0,this.subscription.add(this.catalogService.updateOfURL(`EJEMPLAR/${this.id}`,{id_Ejemplar:this.id,nombre:this.name,imagen:void 0===this.uploadFile.varbinaryImage?btoa(this.uploadFile.uploadedFile[0]):this.uploadFile.varbinaryImage,f_publicacion:this.date,id_Idioma:this.selectedIdioma[0],id_Formato:this.selectedFormato[0],id_Editorial:this.selectedEditorial[0],id_coleccionPertenece:this.selectedCollection[0]}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El ejemplar fue editado satifactoriamente"}),setTimeout(()=>{this.router.navigate([_.u.exemplarsPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo editar el ejemplar"}),this.addLoading=!1}))}loadInfo(){this.subscription.add(this.catalogService.getByNameWithParams(`EJEMPLAR/${this.id}`).subscribe(t=>{t&&(this.isNew=!1),this.id=t.id_Ejemplar,this.selectedCollection.push(t.COLECCION.id_Coleccion),this.date=new Date(t.f_publicacion),this.name=t.nombre,this.selectedFormato.push(t.FORMATOEJEMPLAR.id_formatoEjemplar),this.selectedIdioma.push(t.IDIOMAEJEMPLAR.id_idiomaEjemplar),this.selectedEditorial.push(t.EDITORIAL.id_Editorial),this.uploadFile.uploadedFile.push(t.imagen),setTimeout(()=>{this.loading=!1},200)},()=>{this.loading=!1,this.router.navigate([_.u.exemplarPage])}))}editorialFilter(t){this.editorialText=t.filter}editorialChange(t){this.selectedEditorial=[t.itemValue]}deleteEditorial(t){this.subscription.add(this.catalogService.deleteOfURL(`EDITORIAL/${t}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1\xc9xito!",body:"Editorial eliminada correctamente"}),this.loadEditoriales()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar la editorial"})}))}addEditorial(){this.subscription.add(this.catalogService.addOfURL("EDITORIAL",{editorial1:this.editorialText}).subscribe(t=>{this.loadEditoriales(),this.editorialMultiSelect.close(new Event("close")),this.selectedEditorial=[t.id_Editorial]},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir la editorial"})}))}loadEditoriales(){this.subscription.add(this.catalogService.getByNameWithParams("EDITORIAL").subscribe(t=>{this.editoriales=t}))}idiomaFilter(t){this.idiomaText=t.filter}idiomaChange(t){this.selectedIdioma=[t.itemValue]}deleteIdioma(t){this.subscription.add(this.catalogService.deleteOfURL(`IDIOMAEJEMPLAR/${t}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1\xc9xito!",body:"Idioma eliminado correctamente"}),this.loadIdioma()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar el idioma"})}))}addIdioma(){this.subscription.add(this.catalogService.addOfURL("IDIOMAEJEMPLAR",{idioma:this.idiomaText}).subscribe(t=>{this.loadIdioma(),this.idiomaMultiSelect.close(new Event("close")),this.selectedIdioma=[t.id_idiomaEjemplar]},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el idioma"})}))}loadIdioma(){this.subscription.add(this.catalogService.getByNameWithParams("IDIOMAEJEMPLAR").subscribe(t=>{this.idiomas=t}))}formatoFilter(t){this.formatoText=t.filter}formatoChange(t){this.selectedFormato=[t.itemValue]}loadFormatos(){this.subscription.add(this.catalogService.getByNameWithParams("FORMATOEJEMPLAR").subscribe(t=>{this.formatos=t}))}collectionFilter(t){this.collectionText=t.filter}collectionChange(t){this.selectedCollection=[t.itemValue]}loadCollections(){this.subscription.add(this.catalogService.getByNameWithParams("COLECCION").subscribe(t=>{this.collections=t}))}keywordsFilter(t){this.keywordText=t.filter}keywordsChange(t,i){if(this.selectedKeywordsxExemplar.includes(t.itemValue)){const o=this.keywordsxExemplar.find(l=>l.P_CLAVE.id_p_clave===t.itemValue);this.deleteKeywordToExemplar(o?.id_pClaveEjemplar||0)}else this.addKeywordToExemplar(t.itemValue,i)}loadKeywords(){this.subscription.add(this.catalogService.getByNameWithParams("P_CLAVE").subscribe(t=>{this.keywords=t,this.loadSelectedKeywords()}))}loadSelectedKeywords(){this.subscription.add(this.catalogService.getByNameWithParams("P_CLAVEXEJEMPLAR",(new g.LE).set("id_Ejemplar",this.id)).subscribe(t=>{this.keywordsxExemplar=t,this.selectedKeywords=this.keywordsxExemplar.map(i=>i.P_CLAVE.id_p_clave),this.selectedKeywordsxExemplar=[...this.selectedKeywords]}))}addKeyword(t){this.subscription.add(this.catalogService.addOfURL("P_CLAVE",{p_clave:this.keywordText,id_p_clave:this.id}).subscribe(i=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"La palabra clave fue agregada con \xe9xito"}),this.addKeywordToExemplar(i.id_p_clave,t)},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo agregar la palabra clave"})}))}deleteKeywordToExemplar(t){this.subscription.add(this.catalogService.deleteOfURL(`P_CLAVEXEJEMPLAR/${t}`).subscribe(()=>{this.loadKeywords()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar la palabra clave del ejemplar"})}))}deleteKeyword(t,i){t.stopPropagation();const o=this.keywordsxExemplar.find(l=>l.P_CLAVE.id_p_clave===i);this.subscription.add(this.catalogService.deleteOfURL(`P_CLAVEXEJEMPLAR/${o?.id_pClaveEjemplar||0}`).subscribe(()=>{this.realDeleteKeyword(i)},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar la palabra clave del ejemplar porque tiene datos relacionados"})}))}realDeleteKeyword(t){this.subscription.add(this.catalogService.deleteOfURL(`P_CLAVE/${t}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1\xc9xito!",body:"Palabra clave eliminada correctamente"}),this.loadKeywords()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar la palabra clave porque tiene elementos relacionados"})}))}addKeywordToExemplar(t,i){this.subscription.add(this.catalogService.addOfURL("P_CLAVEXEJEMPLAR",{id_p_clave:t,id_Ejemplar:this.id}).subscribe(()=>{this.loadKeywords(),i.hide()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo agregar la palabra clave"})}))}authorFilter(t){this.authorText=t.filter}authorChange(t,i){if(this.selectedAuthorsxExemplar.includes(t.itemValue)){const o=this.authorsxExemplar.find(l=>l.AUTOR.id_Autor===t.itemValue);this.deleteAuthorToExemplar(o?.id_autorEjemplar||0)}else this.addAuthorToExemplar(t.itemValue,i)}loadAuthors(){this.subscription.add(this.catalogService.getByNameWithParams("AUTOR").subscribe(t=>{this.authors=t,this.loadSelectedAuthors()}))}loadSelectedAuthors(){this.subscription.add(this.catalogService.getByNameWithParams("AUTORXEJEMPLAR",(new g.LE).set("id_Ejemplar",this.id)).subscribe(t=>{this.authorsxExemplar=t,this.selectedAuthors=this.authorsxExemplar.map(i=>i.AUTOR.id_Autor),this.selectedAuthorsxExemplar=[...this.selectedAuthors]}))}addAuthor(t){this.subscription.add(this.catalogService.addOfURL("AUTOR",{nombre:this.authorText,id_Autor:this.id}).subscribe(i=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El autor fue agregado con \xe9xito"}),this.addAuthorToExemplar(i.id_Autor,t)},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo agregar el autor"})}))}deleteAuthorToExemplar(t){this.subscription.add(this.catalogService.deleteOfURL(`AUTORXEJEMPLAR/${t}`).subscribe(()=>{this.loadAuthors()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar el autor del ejemplar"})}))}deleteAuthor(t,i){t.stopPropagation();const o=this.authorsxExemplar.find(l=>l.AUTOR.id_Autor===i);this.subscription.add(this.catalogService.deleteOfURL(`AUTORXEJEMPLAR/${o?.id_autorEjemplar||0}`).subscribe(()=>{this.realDeleteAuthor(i)},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar el autor del ejemplar porque tiene datos relacionados"})}))}realDeleteAuthor(t){this.subscription.add(this.catalogService.deleteOfURL(`AUTOR/${t}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1\xc9xito!",body:"Autor eliminado correctamente"}),this.loadAuthors()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar el autor porque tiene elementos relacionados"})}))}addAuthorToExemplar(t,i){this.subscription.add(this.catalogService.addOfURL("AUTORXEJEMPLAR",{id_Autor:t,id_Ejemplar:this.id}).subscribe(()=>{this.loadAuthors(),i.hide()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo agregar el autor"})}))}loadTags(){this.subscription.add(this.catalogService.getByNameWithParams("ETIQUETASXEJEMPLAR/",(new g.LE).set("id_Ejemplar",this.id)).subscribe(t=>{this.tagsxExemplar=t,this.selectedTags=this.tagsxExemplar.map(i=>i.id_etiquetaEjemplar)}))}deleteTagToExemplar(t){this.subscription.add(this.catalogService.deleteOfURL(`ETIQUETASXEJEMPLAR/${t.value.id_etiquetaEjemplar}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xc9xito",body:"Se elimin\xf3 la etiqueta correctamente"}),this.loadTags()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar correctamente la etiqueta"}),this.loadTags()}))}loadTagTypes(){this.subscription.add(this.catalogService.getByNameWithParams("TIPOETIQUETA").subscribe(t=>{this.tagTypes=t}))}addTag(t){this.subscription.add(this.catalogService.addOfURL("ETIQUETASXEJEMPLAR",{id_tipoEtiqueta:t,etiqueta:this.tagName,id_Ejemplar:this.id}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"La etiqueta fue agregada correctamente"}),this.resetForm(this.tagForm),this.resetForm(this.form),this.loadTags()},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo agregar la etiqueta"})}))}onMask(t){this.tagName=t}getBreadCrumbs(){return[{label:"Ejemplares",routerLink:[this.routeInformation.exemplarsPage]},{label:"Ejemplar",routerLink:[this.routeInformation.exemplarPage]}]}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(E.gz),e.Y36(C.R))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-exemplar-page"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Me,5),e.Gf(Ae,5),e.Gf(Pe,5),e.Gf(Se,5),e.Gf(Fe,5),e.Gf(Ne,5),e.Gf(Ie,5),e.Gf(Oe,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.editorialMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.collectionMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.formatoMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.idiomaMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.keywordMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.authorMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.tagMultiSelect=o.first),e.iGM(o=e.CRH())&&(i.tagForm=o.first)}},features:[e.qOj],decls:6,vars:4,consts:[[1,"card","p-mt-4"],["class","p-d-flex p-ai-center p-jc-center","style","height: 80%",4,"ngIf"],["autocomplete","off","class","p-fluid p-formgrid p-grid p-formgrid-sm p-ml-2 p-mr-2",4,"ngIf"],[1,"p-d-flex","p-ai-center","p-jc-center",2,"height","80%"],["autocomplete","off",1,"p-fluid","p-formgrid","p-grid","p-formgrid-sm","p-ml-2","p-mr-2"],["formModele","ngForm"],[1,"p-col-12","p-mt-2","p-mb-2"],[4,"ngIf"],[1,"p-field","p-col-12","p-mt-2"],["name","selectedKeyword","defaultLabel","Elige una palabra clave","optionLabel","p_clave","optionValue","id_p_clave","emptyFilterMessage","No se encontraron palabras clave","emptyMessage","No se encontraron palabras clave","tooltipPosition","top","display","chip",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","disabled","pTooltip","ngModelChange","onFilter","onChange"],["keywordMultiSelect",""],["pTemplate","item"],["pTemplate","emptyfilter"],[1,"p-field","p-col-12","p-mt-2","p-mb-4"],["name","selectedAuthors","defaultLabel","Elige un autor","optionLabel","nombre","optionValue","id_Autor","emptyFilterMessage","No se encontraron autores","emptyMessage","No se encontraron autores","tooltipPosition","top","display","chip",1,"author-multiselect",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","disabled","pTooltip","ngModelChange","onFilter","onChange"],["authorMultiSelect",""],["tooltipPosition","top","class","p-ml-2",3,"header","selected","disabled","pTooltip",4,"ngFor","ngForOf"],["tooltipPosition","top",1,"p-ml-2",3,"header","selected","disabled","pTooltip"],["tooltipPosition","top",3,"ngModel","max","ngModelOptions","disabled","pTooltip","ngModelChange","onRemove"],["class","animate__animated animate__fadeIn p-mt-4",3,"formGroup",4,"ngIf","ngIfElse"],["ISBN_ISNN",""],[1,"animate__animated","animate__fadeIn","p-mt-4",3,"formGroup"],[1,"p-inputgroup"],["pInputText","","formControlName","DOI","tooltipPosition","top",3,"placeholder","pTooltip"],["pButton","","type","button",3,"disabled","click"],["style","color:red",4,"ngIf"],[2,"color","red"],[1,"animate__animated","animate__fadeIn","p-mt-4"],["tagForm","ngForm"],["tagMask","","required","","pInputText","","name","tagName","tooltipPosition","top",3,"disabled","ngModel","tagType","placeholder","pTooltip","ngModelChange","onMask"],["pButton","","type","submit",3,"disabled","click"],[1,"p-d-flex","p-jc-between","p-ai-center"],[1,"p-d-flex","p-ai-center","p-jc-center"],["pButton","","pRipple","","type","button","label","Eliminar",1,"p-button-danger","p-p-2",3,"click"],["pButton","","pRipple","","type","button",1,"p-button-primary",3,"label","click"],["formModel","ngForm"],[1,"p-field","p-col-12"],[1,"p-input-icon-right"],["name","name","placeholder","Ej. Cr\xf3nicas de Narnia","pInputText","",3,"ngModel","ngModelChange"],[1,"p-field","p-col-12","p-sm-6","p-mt-2"],["name","selectedEditorial","defaultLabel","Elige una editorial","optionLabel","editorial1","optionValue","id_Editorial",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["editorialMultiSelect",""],[1,"p-field","p-col-12","p-sm-3","p-mt-2"],["name","selectedIdioma","defaultLabel","Elige un idioma","optionLabel","idioma","optionValue","id_idiomaEjemplar",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["idiomaMultiSelect",""],["name","selectedFormato","defaultLabel","Elige un formato","optionLabel","formato","optionValue","id_formatoEjemplar","emptyFilterMessage","No se encontraron formatos","emptyMessage","No se encontraron formatos",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["formatoMultiSelect",""],[1,"p-field","p-col-12","p-sm-7","p-mt-2"],["name","selectedCollection","defaultLabel","Elige una colecci\xf3n","optionLabel","nombre","optionValue","id_Coleccion","emptyFilterMessage","No se encontraron colecciones","emptyMessage","No se encontraron colecciones",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["collectionMultiSelect",""],[1,"p-field","p-col-12","p-sm-5","p-mt-2"],[1,"field","col-12","md:col-4"],["name","date","dateFormat","dd-mm-yy",3,"ngModel","maxDate","selectOtherMonths","ngModelChange"],["name","demo[]","chooseLabel","Agregar","invalidFileTypeMessageSummary","{0}: Este formato de archivo no es v\xe1lido.","invalidFileTypeMessageDetail","tipos v\xe1lidos: {0}","accept","image/png",3,"showUploadButton","showCancelButton","onSelect","onUpload"],["pTemplate","content"],[1,"p-col-12","p-grid","p-mt-4","p-ml-0","p-mr-0","p-pl-0","p-pr-0"],[3,"ngClass"],["pButton","","pRipple","","type","button",1,"p-button-success",3,"loading","label","disabled","click"],["class","p-field p-col-6 p-sm-3",4,"ngIf"],["style","height:10em","class","p-ml-2",3,"src","alt",4,"ngIf"],[1,"p-ml-2",2,"height","10em",3,"src","alt"],[1,"p-field","p-col-6","p-sm-3"],["pButton","","pRipple","","type","button","label","Eliminar","icon","pi pi-trash",1,"p-button-danger",3,"loading","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Le,1,0,"app-loading",1),e.YNc(2,Ge,20,15,"form",2),e.qZA(),e.TgZ(3,"div",0),e.YNc(4,qe,1,0,"app-loading",1),e.YNc(5,at,46,36,"form",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading),e.xp6(2),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading))},dependencies:[p.mk,p.sg,p.O5,f.o,u.jx,M.Hq,A.H,P.NU,ae.N,S.f,F.p,N.u,b.xf,b.x4,ue,O,c._Y,c.Fj,c.JJ,c.JL,c.Q7,c.On,c.F,c.sg,c.u,p.gd,we.p,w.A],styles:[".p-tabview-panels{padding:0 1.25rem!important}.p-chips .p-chips-multiple-container .p-chips-token{background:#EAE0FF;color:#694382}.author-multiselect,.author-multiselect .p-multiselect.p-multiselect-chip .p-multiselect-token{background:#FFDEE9;color:#704050}\n"],encapsulation:2}),a})();const ot=[{path:"",component:te},{path:"exemplar",component:L},{path:"exemplar/:id",component:L}];let lt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[E.Bz.forChild(ot),E.Bz]}),a})();var nt=s(6311),st=s(8433),rt=s(4466),pt=s(9423);let dt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.ez]}),a})();var h=s(9592);const ct={provide:c.Cf,useExisting:(0,e.Gpc)(()=>ut),multi:!0},mt={pint:/[\d]/,int:/[\d\-]/,pnum:/[\d\.]/,money:/[\d\.\s,]/,num:/[\d\-\.]/,hex:/[0-9a-f]/i,email:/[a-z0-9_\.\-@]/i,alpha:/[a-z_]/i,alphanum:/[a-z0-9_]/i},k={63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35};let ut=(()=>{class a{constructor(t){this.el=t,this.ngModelChange=new e.vpe,this.isAndroid=h.p.isAndroid()}get pattern(){return this._pattern}set pattern(t){this._pattern=t,this.regex=mt[this._pattern]||this._pattern}isNavKeyPress(t){let i=t.keyCode;return i=h.p.getBrowser().safari&&k[i]||i,i>=33&&i<=40||13==i||9==i||27==i}isSpecialKey(t){let i=t.keyCode||t.charCode;return 9==i||13==i||27==i||16==i||17==i||i>=18&&i<=20||h.p.getBrowser().opera&&!t.shiftKey&&(8==i||i>=33&&i<=35||i>=36&&i<=39||i>=44&&i<=45)}getKey(t){let i=t.keyCode||t.charCode;return h.p.getBrowser().safari&&k[i]||i}getCharCode(t){return t.charCode||t.keyCode||t.which}findDelta(t,i){let o="";for(let l=0;l<t.length;l++)t.substr(0,l)+t.substr(l+t.length-i.length)===i&&(o=t.substr(l,t.length-i.length));return o}isValidChar(t){return this.regex.test(t)}isValidString(t){for(let i=0;i<t.length;i++)if(!this.isValidChar(t.substr(i,1)))return!1;return!0}onInput(t){if(this.isAndroid&&!this.pValidateOnly){let i=this.el.nativeElement.value,o=this.lastValue||"",l=this.findDelta(i,o),r=this.findDelta(o,i);l.length>1||!l&&!r?this.isValidString(i)||(this.el.nativeElement.value=o,this.ngModelChange.emit(o)):r||this.isValidChar(l)||(this.el.nativeElement.value=o,this.ngModelChange.emit(o)),i=this.el.nativeElement.value,this.isValidString(i)&&(this.lastValue=i)}}onKeyPress(t){if(this.isAndroid||this.pValidateOnly)return;let i=h.p.getBrowser(),o=this.getKey(t);if(i.mozilla&&(t.ctrlKey||t.altKey))return;if(17==o||18==o)return;let l=this.getCharCode(t),r=String.fromCharCode(l),d=!0;!i.mozilla&&(this.isSpecialKey(t)||!r)||(d=this.regex.test(r),d||t.preventDefault())}onPaste(t){const i=t.clipboardData||window.clipboardData.getData("text");if(i){const o=i.getData("text");for(let l of o.toString())if(!this.regex.test(l))return void t.preventDefault()}}validate(t){if(this.pValidateOnly){let i=this.el.nativeElement.value;if(i&&!this.regex.test(i))return{validatePattern:!1}}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq))},a.\u0275dir=e.lG2({type:a,selectors:[["","pKeyFilter",""]],hostAttrs:[1,"p-element"],hostBindings:function(t,i){1&t&&e.NdJ("input",function(l){return i.onInput(l)})("keypress",function(l){return i.onKeyPress(l)})("paste",function(l){return i.onPaste(l)})},inputs:{pValidateOnly:"pValidateOnly",pattern:["pKeyFilter","pattern"]},outputs:{ngModelChange:"ngModelChange"},features:[e._Bn([ct])]}),a})(),_t=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[p.ez]]}),a})(),ht=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[C.R],imports:[p.ez,lt,nt.j,f.j,st.ON,M.hJ,A.T,P.q4,rt.m,pt.I,S._8,F.O,g.JF,N.z,b.LU,dt,_t,Te,c.u5,c.UX]}),a})()}}]);