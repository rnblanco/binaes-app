"use strict";(self.webpackChunkpk_thunder_frontend=self.webpackChunkpk_thunder_frontend||[]).push([[173],{8173:(te,u,n)=>{n.r(u),n.d(u,{AreasModule:()=>ee});var l=n(9808),g=n(6507),y=n(2959),c=n(6894),p=n(8203),e=n(7587),v=n(7011),d=n(2382),m=n(1424),h=n(3407),_=n(6526),f=n(7010),A=n(9783),C=n(845),x=n(5787),S=n(3026);const P=["userMultiSelect"],M=["areaTypeMultiSelect"],w=["floorAreaMultiSelect"];function U(a,r){1&a&&e._UZ(0,"app-loading",3)}function N(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addAreaType()}),e.qZA()}if(2&a){const t=e.oxw(2);e.MGl("label","Agregar '",t.areaTypeText,"'")}}function F(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addFloorArea()}),e.qZA()}if(2&a){const t=e.oxw(2);e.MGl("label","Agregar '",t.floorAreaText,"'")}}function E(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",26)(1,"button",27),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).delete()}),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("loading",t.deleteLoading)}}const R=function(a,r){return{"p-col-6 p-sm-9":a,"p-col-12":r}};function L(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"form",4,5)(2,"div",6)(3,"label"),e._uU(4,"Nombre (m\xe1ximo 30 caracteres):"),e.qZA(),e.TgZ(5,"div",7)(6,"input",8),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().name=i}),e.qZA()()(),e.TgZ(7,"div",6)(8,"label"),e._uU(9,"Descripci\xf3n:"),e.qZA(),e.TgZ(10,"div",7)(11,"textarea",9),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().description=i}),e.qZA()()(),e.TgZ(12,"div",10)(13,"label"),e._uU(14,"Encargado:"),e.qZA(),e.TgZ(15,"p-multiSelect",11,12),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().selectedUser=i})("onFilter",function(i){return e.CHM(t),e.oxw().userFilter(i)})("onChange",function(i){return e.CHM(t),e.oxw().userChange(i)}),e.qZA()(),e.TgZ(17,"div",13)(18,"label"),e._uU(19,"Capacidad del \xe1rea:"),e.qZA(),e.TgZ(20,"p-inputNumber",14),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().capacity=i}),e.qZA()(),e.TgZ(21,"div",15)(22,"label"),e._uU(23,"Tipo de \xe1rea:"),e.qZA(),e.TgZ(24,"p-multiSelect",16,17),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().selectedAreaType=i})("onFilter",function(i){return e.CHM(t),e.oxw().areaTypeFilter(i)})("onChange",function(i){return e.CHM(t),e.oxw().areaTypeChange(i)}),e.YNc(26,N,1,1,"ng-template",18),e.qZA()(),e.TgZ(27,"div",15)(28,"label"),e._uU(29,"Piso:"),e.qZA(),e.TgZ(30,"p-multiSelect",19,20),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().selectedFloorArea=i})("onFilter",function(i){return e.CHM(t),e.oxw().floorAreaFilter(i)})("onChange",function(i){return e.CHM(t),e.oxw().floorAreaChange(i)}),e.YNc(32,F,1,1,"ng-template",18),e.qZA()(),e.TgZ(33,"div",21)(34,"div",22)(35,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().add()}),e.ALo(36,"addOrEdit"),e.qZA()(),e.YNc(37,E,2,1,"div",24),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.name),e.xp6(5),e.Q6J("ngModel",t.description)("autoResize",!0),e.xp6(4),e.Q6J("options",t.users)("ngModel",t.selectedUser)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(5),e.Q6J("ngModel",t.capacity)("showButtons",!0)("min",0)("max",1e3),e.xp6(4),e.Q6J("options",t.areaTypes)("ngModel",t.selectedAreaType)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(6),e.Q6J("options",t.floorAreas)("ngModel",t.selectedFloorArea)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(4),e.Q6J("ngClass",e.WLB(29,R,t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew,t.isNew||t.user.id_rolUsuario!==t.SUPER_ADMIN)),e.xp6(1),e.Q6J("loading",t.addLoading)("label",e.lcZ(36,27,t.isNew))("disabled",!t.formIsValid),e.xp6(2),e.Q6J("ngIf",t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew)}}let T=(()=>{class a extends y.H{constructor(t){super(),this.route=t,this.SUPER_ADMIN=c.G.SUPER_ADMIN,this.isNew=!0,this.addLoading=!1,this.deleteLoading=!1,this.userText="",this.selectedUser=[],this.areaTypeText="",this.selectedAreaType=[],this.floorAreaText="",this.selectedFloorArea=[]}get formIsValid(){var t,o,i;return""!==this.name&&""!==this.description&&this.capacity>0&&(null===(t=this.selectedUser)||void 0===t?void 0:t.length)>0&&(null===(o=this.selectedAreaType)||void 0===o?void 0:o.length)>0&&(null===(i=this.selectedFloorArea)||void 0===i?void 0:i.length)>0}ngOnInit(){this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){this.subscription.add(this.route.params.subscribe(({id:t})=>{this.loading=!0,this.loadAreaTypes(),this.loadUsers(),this.loadFloorAreas(),t?(this.id=t,this.loadInfo()):this.loading=!1}))}delete(){this.deleteLoading=!0,this.subscription.add(this.catalogService.deleteOfURL(`AREA/${this.id}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El \xe1rea fue eliminada con \xe9xito"}),setTimeout(()=>{this.router.navigate([p.u.areasPage])},200),this.deleteLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar el \xe1rea"}),this.deleteLoading=!1}))}add(){this.isNew?(this.addLoading=!0,this.subscription.add(this.catalogService.addOfURL("AREA",{nombre:this.name,descripcion:this.description,capacidad:this.capacity,responsable:this.selectedUser[0],id_pisoArea:this.selectedFloorArea[0],id_tipoArea:this.selectedAreaType[0]}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El \xe1rea fue a\xf1adida satifactoriamente"}),setTimeout(()=>{this.router.navigate([p.u.areasPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el \xe1rea"}),this.addLoading=!1}))):this.update()}update(){this.addLoading=!0,this.subscription.add(this.catalogService.updateOfURL(`AREA/${this.id}`,{id_Area:this.id,nombre:this.name,descripcion:this.description,capacidad:this.capacity,responsable:this.selectedUser[0],id_pisoArea:this.selectedFloorArea[0],id_tipoArea:this.selectedAreaType[0]}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"El \xe1rea fue editada satifactoriamente"}),setTimeout(()=>{this.router.navigate([p.u.areasPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo editar el \xe1rea"}),this.addLoading=!1}))}loadInfo(){this.subscription.add(this.catalogService.getByNameWithParams(`AREA/${this.id}`).subscribe(t=>{var o;t.nombre&&(this.isNew=!1),this.id=t.id_Area,this.name=t.nombre,this.description=t.descripcion,this.capacity=t.capacidad,this.selectedUser=[t.USUARIO.id_Usuario],this.selectedAreaType=[null===(o=t.TIPOAREA)||void 0===o?void 0:o.id_tipoArea],this.selectedFloorArea=[t.PISOAREA.id_pisoArea],setTimeout(()=>{this.loading=!1},200)},()=>{this.loading=!1,this.router.navigate([p.u.areasPage])}))}userFilter(t){this.userText=t.filter}userChange(t){this.selectedUser=[t.itemValue]}loadUsers(){this.subscription.add(this.catalogService.getByNameWithParams("USUARIO").subscribe(t=>{this.users=t}))}areaTypeFilter(t){this.areaTypeText=t.filter}areaTypeChange(t){this.selectedAreaType=[t.itemValue]}addAreaType(){this.subscription.add(this.catalogService.addOfURL("TIPOAREA",{tipoArea1:this.areaTypeText}).subscribe(t=>{this.loadAreaTypes(),this.areaTypeMultiSelect.close(new Event("close")),this.selectedAreaType=[t.id_tipoArea]},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el tipo de \xe1rea"})}))}loadAreaTypes(){this.subscription.add(this.catalogService.getByNameWithParams("TIPOAREA").subscribe(t=>{this.areaTypes=t}))}floorAreaFilter(t){this.floorAreaText=t.filter}floorAreaChange(t){this.selectedFloorArea=[t.itemValue]}addFloorArea(){this.subscription.add(this.catalogService.addOfURL("PISOAREA",{pisoArea1:this.floorAreaText}).subscribe(t=>{this.loadAreaTypes(),this.floorAreaMultiSelect.close(new Event("close")),this.selectedAreaType=[t.id_pisoArea]},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el tipo de \xe1rea"})}))}loadFloorAreas(){this.subscription.add(this.catalogService.getByNameWithParams("PISOAREA").subscribe(t=>{this.floorAreas=t}))}getBreadCrumbs(){return[{label:"\xc1reas",routerLink:[this.routeInformation.areasPage]},{label:"\xc1rea",routerLink:[this.routeInformation.areaPage]}]}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(g.gz))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-area-page"]],viewQuery:function(t,o){if(1&t&&(e.Gf(P,5),e.Gf(M,5),e.Gf(w,5)),2&t){let i;e.iGM(i=e.CRH())&&(o.userMultiSelect=i.first),e.iGM(i=e.CRH())&&(o.areaTypeMultiSelect=i.first),e.iGM(i=e.CRH())&&(o.floorAreaMultiSelect=i.first)}},features:[e.qOj],decls:3,vars:2,consts:[[1,"card","p-mt-4"],["class","p-d-flex p-ai-center p-jc-center","style","height: 80%",4,"ngIf"],["autocomplete","off","class","p-fluid p-formgrid p-grid p-formgrid-sm p-ml-2 p-mr-2",4,"ngIf"],[1,"p-d-flex","p-ai-center","p-jc-center",2,"height","80%"],["autocomplete","off",1,"p-fluid","p-formgrid","p-grid","p-formgrid-sm","p-ml-2","p-mr-2"],["form","ngForm"],[1,"p-field","p-col-12"],[1,"p-input-icon-right"],["name","name","placeholder","Ej. \xc1rea de recreaci\xf3n","pInputText","","maxlength","30",3,"ngModel","ngModelChange"],["name","description","placeholder","Ej. Espacio para desarrollar las habilidades sociales","pInputTextarea","",3,"ngModel","autoResize","ngModelChange"],[1,"p-field","p-col-8","p-mt-2"],["name","selectedUser","defaultLabel","Elige un encargado","optionLabel","nombre","optionValue","id_Usuario","emptyFilterMessage","No se encontraron resultados",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["userMultiSelect",""],[1,"p-field","p-col-4","p-mt-2"],["name","capacity","inputId","minmax-buttons",3,"ngModel","showButtons","min","max","ngModelChange"],[1,"p-field","p-col-6","p-mt-2"],["name","selectedAreaType","defaultLabel","Elige un tipo","optionLabel","tipoArea1","optionValue","id_tipoArea",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["areaTypeMultiSelect",""],["pTemplate","emptyfilter"],["name","selectedFloorArea","defaultLabel","Elige un piso","optionLabel","pisoArea1","optionValue","id_pisoArea",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["floorAreaMultiSelect",""],[1,"p-col-12","p-grid","p-mt-4","p-ml-0","p-mr-0","p-pl-0","p-pr-0"],[1,"p-field",3,"ngClass"],["pButton","","pRipple","","type","button",1,"p-button-success",3,"loading","label","disabled","click"],["class","p-field p-col-6 p-sm-3",4,"ngIf"],["pButton","","pRipple","","type","button",1,"p-button-primary",3,"label","click"],[1,"p-field","p-col-6","p-sm-3"],["pButton","","pRipple","","type","button","label","Eliminar","icon","pi pi-trash",1,"p-button-danger",3,"loading","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.YNc(1,U,1,0,"app-loading",1),e.YNc(2,L,38,32,"form",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",o.loading),e.xp6(1),e.Q6J("ngIf",!o.loading))},directives:[l.O5,v.N,d._Y,d.JL,d.F,d.Fj,m.o,d.nD,d.JJ,d.On,h.g,_.NU,f.Rn,A.jx,C.Hq,x.H,l.mk],pipes:[S.p],encapsulation:2}),a})();var Z=n(9908),I=n(414),b=n(2472);function J(a,r){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t?null:t.capacidad," ")}}function O(a,r){if(1&a&&(e.ynx(0),e._UZ(1,"p-chip",7),e.ALo(2,"titlecase"),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("image","assets/images/icons/user-circle.png")("label",e.lcZ(2,2,null==t||null==t.USUARIO?null:t.USUARIO.nombre))}}function H(a,r){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t?null:t.descripcion," ")}}function B(a,r){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t?null:t.nombre," ")}}function Q(a,r){if(1&a&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&a){const t=e.oxw().$implicit,o=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,o[t.field])," ")}}function j(a,r){if(1&a&&(e.TgZ(0,"td",4),e.YNc(1,J,2,1,"ng-container",5),e.YNc(2,O,3,4,"ng-container",5),e.YNc(3,H,2,1,"ng-container",5),e.YNc(4,B,2,1,"ng-container",5),e.YNc(5,Q,3,3,"ng-container",6),e.qZA()),2&a){const t=r.$implicit;e.Udp("width",t.width,"px"),e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngSwitchCase","capacidad"),e.xp6(1),e.Q6J("ngSwitchCase","USUARIO.nombre"),e.xp6(1),e.Q6J("ngSwitchCase","descripcion"),e.xp6(1),e.Q6J("ngSwitchCase","nombre")}}function D(a,r){1&a&&e.YNc(0,j,6,7,"td",3),2&a&&e.Q6J("ngForOf",r.columns)}const Y=[{path:"",component:(()=>{class a extends Z.c{constructor(){super(),this.USER=c.G.USER,this.cols=[{field:"nombre",header:"Nombre",width:150},{field:"descripcion",header:"Descripci\xf3n",width:200},{field:"USUARIO.nombre",header:"Responsable",width:100},{field:"capacidad",header:"Capacidad",width:100}]}ngOnInit(){this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){this.list=[],this.loading=!0,this.getPaginationParams(),this.subscription.add(this.catalogService.getByNameWithParams("AREA",this.httpParams).subscribe(t=>{this.pagination=t.meta,this.currentPage=this.pagination.currentPage,this.list=t.data,this.loading=!1},()=>this.loading=!1))}onLazyLoad(t){this.paginate(t),this.loadAll()}onNew(){this.user.id_rolUsuario!==c.G.USER&&this.router.navigate([`${this.routeInformation.areaPage}/`])}onRowSelect({data:t}){this.user.id_rolUsuario!==c.G.USER&&this.router.navigate([`${this.routeInformation.areaPage}/${t.id_Area}/`])}getBreadCrumbs(){return[{label:"\xc1reas",routerLink:[this.routeInformation.areasPage]}]}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-areas-page"]],features:[e.qOj],decls:3,vars:8,consts:[[1,"p-mt-4"],["newButtonLabel","Nueva \xe1rea","type","\xe1reas",3,"reloading","globalFilter","rows","pagination","loading","cols","list","showNewButton","onLazyLoad","onRowSelect","onNewClick"],["pTemplate","body"],["class","text-center",3,"ngSwitch","width",4,"ngFor","ngForOf"],[1,"text-center",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["styleClass","p-col-12",3,"image","label"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"table-card",1),e.NdJ("onLazyLoad",function(s){return o.onLazyLoad(s)})("onRowSelect",function(s){return o.onRowSelect(s)})("onNewClick",function(){return o.onNew()}),e.YNc(2,D,1,1,"ng-template",2),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("reloading",o.loading)("globalFilter",o.globalFilter)("rows",o.rows)("pagination",o.pagination)("loading",o.loading)("cols",o.cols)("list",o.list)("showNewButton",o.user.id_rolUsuario!==o.USER))},directives:[I.r,A.jx,l.sg,l.RF,l.n9,b.A,l.ED],pipes:[l.rS],encapsulation:2}),a})()},{path:"area",component:T},{path:"area/:id",component:T}];let z=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[g.Bz.forChild(Y)],g.Bz]}),a})();var G=n(8007),$=n(5055),V=n(4466),W=n(9423),X=n(5652),k=n(8205),K=n(520),q=n(3725);let ee=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[l.ez,z,G.j,d.u5,m.j,$.ON,C.hJ,x.T,_.q4,V.m,W.I,X._8,k.O,K.JF,f.L$,h.A,q.LU,b.o]]}),a})()}}]);