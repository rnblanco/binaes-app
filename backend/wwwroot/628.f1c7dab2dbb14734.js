"use strict";(self.webpackChunkpk_thunder_frontend=self.webpackChunkpk_thunder_frontend||[]).push([[628],{3628:(V,u,s)=>{s.r(u),s.d(u,{CollectionsModule:()=>D});var r=s(6895),g=s(2248),b=s(9908),d=s(6894),e=s(8274),y=s(414),m=s(805);function N(o,l){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&o){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t||null==t.TIPOCOLECCION?null:t.TIPOCOLECCION.tipoColeccion1)," ")}}function x(o,l){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&o){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t||null==t.GENEROCOLECCION?null:t.GENEROCOLECCION.generoColeccion1)," ")}}function P(o,l){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"titlecase"),e.BQk()),2&o){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t||null==t.AREA?null:t.AREA.nombre)," ")}}function E(o,l){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw().$implicit,i=e.oxw().rowData;e.xp6(1),e.hij(" ",i[t.field]," ")}}function w(o,l){if(1&o&&(e.TgZ(0,"td",4),e.YNc(1,N,3,3,"ng-container",5),e.YNc(2,x,3,3,"ng-container",5),e.YNc(3,P,3,3,"ng-container",5),e.YNc(4,E,2,1,"ng-container",6),e.qZA()),2&o){const t=l.$implicit;e.Udp("width",t.width,"px"),e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngSwitchCase","TIPOCOLECCION.tipoColeccion1"),e.xp6(1),e.Q6J("ngSwitchCase","GENEROCOLECCION.generoColeccion1"),e.xp6(1),e.Q6J("ngSwitchCase","AREA.nombre")}}function O(o,l){1&o&&e.YNc(0,w,5,6,"td",3),2&o&&e.Q6J("ngForOf",l.columns)}let S=(()=>{class o extends b.c{constructor(){super(),this.USER=d.G.USER,this.cols=[{field:"nombre",header:"Nombre",width:100},{field:"TIPOCOLECCION.tipoColeccion1",header:"Tipo",width:100},{field:"GENEROCOLECCION.generoColeccion1",header:"G\xe9nero",width:150},{field:"AREA.nombre",header:"\xc1rea",width:175}]}ngOnInit(){this.loadAll(),this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){this.list=[],this.loading=!0,this.getPaginationParams(),this.subscription.add(this.catalogService.getByNameWithParams("COLECCION",this.httpParams).subscribe(t=>{this.pagination=t.meta,this.currentPage=this.pagination.currentPage,this.list=t.data,this.loading=!1},()=>this.loading=!1))}onLazyLoad(t){this.paginate(t),this.loadAll()}onNew(){this.user.id_rolUsuario!==d.G.USER&&this.router.navigate([`${this.routeInformation.collectionPage}/`])}onRowSelect({data:t}){this.user.id_rolUsuario!==d.G.USER&&this.router.navigate([`${this.routeInformation.collectionPage}/${t.id_Coleccion}/`])}getBreadCrumbs(){return[{label:"Colecciones",routerLink:[this.routeInformation.collectionsPage]}]}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-collections-page"]],features:[e.qOj],decls:3,vars:8,consts:[[1,"p-mt-4"],["newButtonLabel","Nueva colecci\xf3n","type","colecciones",3,"reloading","globalFilter","rows","pagination","loading","cols","list","showNewButton","onLazyLoad","onRowSelect","onNewClick"],["pTemplate","body"],["class","text-center",3,"ngSwitch","width",4,"ngFor","ngForOf"],[1,"text-center",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"table-card",1),e.NdJ("onLazyLoad",function(a){return i.onLazyLoad(a)})("onRowSelect",function(a){return i.onRowSelect(a)})("onNewClick",function(){return i.onNew()}),e.YNc(2,O,1,1,"ng-template",2),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("reloading",i.loading)("globalFilter",i.globalFilter)("rows",i.rows)("pagination",i.pagination)("loading",i.loading)("cols",i.cols)("list",i.list)("showNewButton",i.user.id_rolUsuario!==i.USER))},dependencies:[r.sg,r.RF,r.n9,r.ED,y.r,m.jx,r.rS],encapsulation:2}),o})();var v=s(2959),p=s(8203),c=s(433),C=s(1740),h=s(5593),_=s(1795),f=s(5722),L=s(7011),A=s(3026);const M=["typeMultiSelect"],I=["genreMultiSelect"],G=["areaMultiSelect"];function R(o,l){1&o&&e._UZ(0,"app-loading",3)}function F(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.addType())}),e.qZA()}if(2&o){const t=e.oxw(2);e.MGl("label","Agregar '",t.typeText,"'")}}function Z(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.addGenre())}),e.qZA()}if(2&o){const t=e.oxw(2);e.MGl("label","Agregar '",t.genreText,"'")}}function U(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",23)(1,"button",24),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.delete())}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("loading",t.deleteLoading)}}const J=function(o,l){return{"p-col-6 p-sm-9":o,"p-col-12":l}};function H(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"form",4,5)(2,"div",6)(3,"label"),e._uU(4,"Nombre:"),e.qZA(),e.TgZ(5,"div",7)(6,"input",8),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.name=n)}),e.qZA()()(),e.TgZ(7,"div",9)(8,"label"),e._uU(9,"\xc1rea:"),e.qZA(),e.TgZ(10,"p-multiSelect",10,11),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedArea=n)})("onFilter",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.areaFilter(n))})("onChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.areaChange(n))}),e.qZA()(),e.TgZ(12,"div",12)(13,"label"),e._uU(14,"Tipo:"),e.qZA(),e.TgZ(15,"p-multiSelect",13,14),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedType=n)})("onFilter",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.typeFilter(n))})("onChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.typeChange(n))}),e.YNc(17,F,1,1,"ng-template",15),e.qZA()(),e.TgZ(18,"div",12)(19,"label"),e._uU(20,"G\xe9nero:"),e.qZA(),e.TgZ(21,"p-multiSelect",16,17),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedGenre=n)})("onFilter",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.genreFilter(n))})("onChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.genreChange(n))}),e.YNc(23,Z,1,1,"ng-template",15),e.qZA()(),e.TgZ(24,"div",18)(25,"div",19)(26,"button",20),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.add())}),e.ALo(27,"addOrEdit"),e.qZA()(),e.YNc(28,U,2,1,"div",21),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.name),e.xp6(4),e.Q6J("options",t.areas)("ngModel",t.selectedArea)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(5),e.Q6J("options",t.types)("ngModel",t.selectedType)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(6),e.Q6J("options",t.genres)("ngModel",t.selectedGenre)("showToggleAll",!1)("showClear",!0)("resetFilterOnHide",!0),e.xp6(4),e.Q6J("ngClass",e.WLB(23,J,t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew,t.isNew||t.user.id_rolUsuario!==t.SUPER_ADMIN)),e.xp6(1),e.Q6J("loading",t.addLoading)("label",e.lcZ(27,21,t.isNew))("disabled",!t.formIsValid),e.xp6(2),e.Q6J("ngIf",t.user.id_rolUsuario===t.SUPER_ADMIN&&!t.isNew)}}let T=(()=>{class o extends v.H{constructor(t){super(),this.route=t,this.SUPER_ADMIN=d.G.SUPER_ADMIN,this.isNew=!0,this.addLoading=!1,this.deleteLoading=!1,this.typeText="",this.selectedType=[],this.genreText="",this.selectedGenre=[],this.areaText="",this.selectedArea=[]}get formIsValid(){return""!==this.name&&this.selectedType?.length>0&&this.selectedGenre?.length>0&&this.selectedArea?.length>0}ngOnInit(){this.loadAll(),this.user=this.authService.storagedUser,this.breadcrumbService.setItems(this.getBreadCrumbs())}loadAll(){this.user.id_rolUsuario===d.G.USER&&(this.messageService.setPayload({type:"warn",title:"Error",body:"No tienes autorizaci\xf3n para ver esta informaci\xf3n"}),setTimeout(()=>{this.router.navigate([p.u.collectionsPage])},50)),this.subscription.add(this.route.params.subscribe(({id:t})=>{this.loading=!0,this.loadTypes(),this.loadGenres(),this.loadAreas(),t?(this.id=t,this.loadInfo()):this.loading=!1}))}delete(){this.deleteLoading=!0,this.subscription.add(this.catalogService.deleteOfURL(`COLECCION/${this.id}`).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"La colecci\xf3n fue eliminada con \xe9xito"}),setTimeout(()=>{this.router.navigate([p.u.collectionsPage])},200),this.deleteLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo eliminar la colecci\xf3n"}),this.deleteLoading=!1}))}add(){this.isNew?(this.addLoading=!0,this.subscription.add(this.catalogService.addOfURL("COLECCION",{nombre:this.name,id_tipoColeccion:this.selectedType[0],id_generoColeccion:this.selectedGenre[0],id_areaPertenece:this.selectedArea[0]}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"La colecci\xf3n fue a\xf1adida satifactoriamente"}),setTimeout(()=>{this.router.navigate([p.u.collectionsPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir la colecci\xf3n"}),this.addLoading=!1}))):this.update()}update(){this.addLoading=!0,this.subscription.add(this.catalogService.updateOfURL(`COLECCION/${this.id}`,{id_Coleccion:this.id,nombre:this.name,id_tipoColeccion:this.selectedType[0],id_generoColeccion:this.selectedGenre[0],id_areaPertenece:this.selectedArea[0]}).subscribe(()=>{this.messageService.setPayload({type:"success",title:"\xa1Exito!",body:"La colecci\xf3n fue editada satifactoriamente"}),setTimeout(()=>{this.router.navigate([p.u.collectionsPage])},200),this.addLoading=!1},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo editar la colecci\xf3n"}),this.addLoading=!1}))}loadInfo(){this.subscription.add(this.catalogService.getByNameWithParams(`COLECCION/${this.id}`).subscribe(t=>{t.nombre&&(this.isNew=!1),this.name=t.nombre,this.selectedArea=[t.AREA.id_Area],this.selectedGenre=[t.GENEROCOLECCION.id_generoColeccion],this.selectedType=[t.TIPOCOLECCION.id_tipoColeccion],setTimeout(()=>{this.loading=!1},200)},()=>{this.loading=!1,this.router.navigate([p.u.collectionPage])}))}typeFilter(t){this.typeText=t.filter}typeChange(t){this.selectedType=[t.itemValue]}addType(){this.subscription.add(this.catalogService.addOfURL("TIPOCOLECCION",{tipoColeccion1:this.typeText}).subscribe(t=>{this.loadTypes(),this.typeMultiSelect.close(new Event("close")),this.selectedType=[t.id_tipoColeccion]},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el tipo"})}))}loadTypes(){this.subscription.add(this.catalogService.getByNameWithParams("TIPOCOLECCION").subscribe(t=>{this.types=t}))}genreFilter(t){this.genreText=t.filter}genreChange(t){this.selectedGenre=[t.itemValue]}addGenre(){this.subscription.add(this.catalogService.addOfURL("GENEROCOLECCION",{generoColeccion1:this.genreText}).subscribe(t=>{this.loadGenres(),this.genreMultiSelect.close(new Event("close")),this.selectedGenre=[t.id_generoColeccion]},()=>{this.messageService.setPayload({type:"warn",title:"Error",body:"No se pudo a\xf1adir el g\xe9nero"})}))}loadGenres(){this.subscription.add(this.catalogService.getByNameWithParams("GENEROCOLECCION").subscribe(t=>{this.genres=t}))}areaFilter(t){this.areaText=t.filter}areaChange(t){this.selectedArea=[t.itemValue]}loadAreas(){this.subscription.add(this.catalogService.getByNameWithParams("AREA").subscribe(t=>{this.areas=t}))}getBreadCrumbs(){return[{label:"Colecciones",routerLink:[this.routeInformation.collectionsPage]},{label:"Colecci\xf3n",routerLink:[this.routeInformation.collectionPage]}]}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-collection-page"]],viewQuery:function(t,i){if(1&t&&(e.Gf(M,5),e.Gf(I,5),e.Gf(G,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.typeMultiSelect=n.first),e.iGM(n=e.CRH())&&(i.genreMultiSelect=n.first),e.iGM(n=e.CRH())&&(i.areaMultiSelect=n.first)}},features:[e.qOj],decls:3,vars:2,consts:[[1,"card","p-mt-4"],["class","p-d-flex p-ai-center p-jc-center","style","height: 80%",4,"ngIf"],["autocomplete","off","class","p-fluid p-formgrid p-grid p-formgrid-sm p-ml-2 p-mr-2",4,"ngIf"],[1,"p-d-flex","p-ai-center","p-jc-center",2,"height","80%"],["autocomplete","off",1,"p-fluid","p-formgrid","p-grid","p-formgrid-sm","p-ml-2","p-mr-2"],["form","ngForm"],[1,"p-field","p-col-12"],[1,"p-input-icon-right"],["name","name","placeholder","Ej. Cr\xf3nicas de Narnia","pInputText","",3,"ngModel","ngModelChange"],[1,"p-field","p-col-12","p-mt-2"],["name","selectedArea","defaultLabel","Elige un \xe1rea","optionLabel","nombre","optionValue","id_Area","emptyFilterMessage","No se encontraron \xe1reas","emptyMessage","No se encontraron \xe1reas",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["areaMultiSelect",""],[1,"p-field","p-col-6","p-mt-2"],["name","selectedType","defaultLabel","Elige un tipo","optionLabel","tipoColeccion1","optionValue","id_tipoColeccion",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["typeMultiSelect",""],["pTemplate","emptyfilter"],["name","selectedGenre","defaultLabel","Elige un g\xe9nero","optionLabel","generoColeccion1","optionValue","id_generoColeccion",3,"options","ngModel","showToggleAll","showClear","resetFilterOnHide","ngModelChange","onFilter","onChange"],["genreMultiSelect",""],[1,"p-col-12","p-grid","p-mt-4","p-ml-0","p-mr-0","p-pl-0","p-pr-0"],[1,"p-field",3,"ngClass"],["pButton","","pRipple","","type","button",1,"p-button-success",3,"loading","label","disabled","click"],["class","p-field p-col-6 p-sm-3",4,"ngIf"],["pButton","","pRipple","","type","button",1,"p-button-primary",3,"label","click"],[1,"p-field","p-col-6","p-sm-3"],["pButton","","pRipple","","type","button","label","Eliminar","icon","pi pi-trash",1,"p-button-danger",3,"loading","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,R,1,0,"app-loading",1),e.YNc(2,H,29,26,"form",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading))},dependencies:[r.mk,r.O5,c._Y,c.Fj,c.JJ,c.JL,c.On,c.F,C.o,m.jx,h.Hq,_.H,f.NU,L.N,A.p],encapsulation:2}),o})();const B=[{path:"",component:S},{path:"collection",component:T},{path:"collection/:id",component:T}];let Q=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(B),g.Bz]}),o})();var j=s(6311),K=s(8433),Y=s(4466),z=s(9423);let D=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[r.ez,Q,j.j,c.u5,C.j,K.ON,h.hJ,_.T,f.q4,Y.m,z.I]}),o})()}}]);